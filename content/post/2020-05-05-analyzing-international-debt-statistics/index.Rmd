---
title: Analyzing International Debt Statistics
author: Qiushi Yan
date: '2020-05-05'
slug: international-debt-sql
categories:
  - Data Analysis
  - SQL
  - Data Visualization
summary: 'Write SQL queries to analyze international debt from the World Bank, and make ggplot2 visulizations.'
lastmod: '2020-05-05T18:42:11+08:00'
draft: yes
image:
  caption: ''
  focal_point: ''
  preview_only: yes
---

In this post, I use SQL to retrieve and analyze international debt data collected by The World Bank. The dataset contains information about the amount of debt (in USD `r emo::ji("dollar")`) owed by developing countries across several categories. In fact, I adopted this from one [DataCamp project](https://learn.datacamp.com/projects/754) without following its instructions. The project is still insightful and well-written, though.  Also, the R Markdown documentation has a section on how to [embed SQL chunks](https://bookdown.org/yihui/rmarkdown/language-engines.html#sqls)

```{r, include = FALSE}
knitr::opts_chunk$set(message = FALSE,
                      warning = FALSE,
                      comment = "#>",
                      collapse = TRUE,
                      tab.cap = NA)
```



After connecting the a database, I start by `CREATE` the `international_debt` table.
```{r, include = FALSE}
library(RPostgreSQL)
library(DBI)

con <- dbConnect(DBI::dbDriver('PostgreSQL'), 
                 dbname = "analysis",
                 host = "localhost",
                 port = 5432,
                 user = "postgres",
                 password = "Yanqiushi123")

international_debt <- readr::read_csv("D:/RProjects/data/blog/international_debt.csv")
```



```{sql connection=con, eval = FALSE}
CREATE TABLE international_debt (
	country_name varchar(50),
	country_code varchar(10),
	indicator_name varchar(100),
	indicator_code varchar(20),
	debt decimal(12, 1)
)
```

Then we can upload debt data into that table. If you happen to be a datacamp subscriber, [here](https://support.datacamp.com/hc/en-us/articles/360020444334-How-to-Download-Project-Datasets) are some instructions on how to dowanload the data. ^[The following chunk is not a real SQL query but plain text. The knitr SQL engine currently only looks for the keywords that are among `INSERT`, `UPDATE`, `DELETE`, `CREATE` and `SELECT`. You have to run the command inside the database.]

```sql
COPY international_debt
FROM 'D:/RProjects/data/blog/international_debt.csv'
WITH (FORMAT csv, header)
```


```{sql connection=con}
-- SELECT * FROM international_debt LIMIT 10
SELECT DISTINCT(country_name) 
FROM international_debt
LIMIT 6
```







