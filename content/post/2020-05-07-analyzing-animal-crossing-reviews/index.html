---
title: Analyzing Animal Crossing Reviews
author: Qiushi Yan
date: '2020-05-07'
categories:
  - Data Analysis
  - Machine Learning
  - R
tags: []
subtitle: ''
draft: yes
image:
  caption: ''
  focal_point: ''
  preview_only: yes
---


<div id="TOC">
<ul>
<li><a href="#eda-and-data-cleaning">EDA and data cleaning</a><ul>
<li><a href="#results">Results</a><ul>
<li><a href="#repeated-reviews">Repeated reviews</a></li>
<li><a href="#incomplete-reviews-because-they-are-too-long">Incomplete reviews because they are too long</a></li>
<li><a href="#non-english-reviews">Non-English reviews</a></li>
</ul></li>
<li><a href="#section"></a></li>
</ul></li>
<li><a href="#sentiment-analysis-of-user-reviews">Sentiment analysis of user reviews</a></li>
<li><a href="#predictive-modeling-for-grades-with-user-reviews">Predictive modeling for grades with user reviews</a></li>
</ul>
</div>

<p>Our modeling goal is to predict the rating for the life simulation video game, Animal Crossing, from its user reviews. The data comes from <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-05-05/readme.md">this weeks’s <code>#TidyTuesday</code></a>, scraped from <a href="https://github.com/jefflomacy/villagerdb">VillagerDB</a> and <a href="https://www.metacritic.com/game/switch/animal-crossing-new-horizons/critic-reviews">Metacritic</a>.</p>
<pre class="r"><code>library(tidyverse)
library(tidytext)
set.seed(2020)</code></pre>
<div id="eda-and-data-cleaning" class="section level1">
<h1>EDA and data cleaning</h1>
<p>The reviews data contains four columns:</p>
<ul>
<li><code>grade</code>: 0-100 score given by the critic (missing for some) where higher score = better.</li>
<li><code>user_name</code>: user name of the reviewer</li>
<li><code>text</code>: review of the reviewer</li>
<li><code>date</code>: when the review is published</li>
</ul>
<pre class="r"><code>reviews &lt;- readr::read_tsv(&quot;D:/RProjects/data/blog/animal-crossing-reviews.tsv&quot;)
glimpse(reviews)
#&gt; Rows: 1,473
#&gt; Columns: 4
#&gt; $ grade     &lt;dbl&gt; 4, 5, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, ...
#&gt; $ user_name &lt;chr&gt; &quot;mds27272&quot;, &quot;lolo2178&quot;, &quot;Roachant&quot;, &quot;Houndf&quot;, &quot;ProfessorF...
#&gt; $ text      &lt;chr&gt; &quot;My gf started playing before me. No option to create my ...
#&gt; $ date      &lt;date&gt; 2020-03-20, 2020-03-20, 2020-03-20, 2020-03-20, 2020-03-...</code></pre>
<p>An bar plot of all grades show a bimodal distribution. This is perhaps not that astonishing when it comes to reviewing, since people tend to go to extremes and give polarized opinions. This may suggest that we cut <code>grades</code> into discrete levels and build a classification model afterwards, rather than modeling bare grades itself with regression models.</p>
<pre class="r"><code>reviews %&gt;% 
  count(grade) %&gt;% 
  ggplot() + 
  geom_col(aes(x = factor(grade), 
               y = n),
           fill = &quot;midnightblue&quot;, alpha = 0.6) + 
  labs(x = &quot;grade&quot;, y = NULL)</code></pre>
<p><img src="/post/2020-05-07-analyzing-animal-crossing-reviews/index_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<p>The data is messy in several ways (I have chosen 3 lines for example):</p>
<ul>
<li><p>Review contains repetition. the following review where the first 4.5 lines are repeated in the following lines</p></li>
<li><p>reviews that exceed certian length are incomplete and end with “Expand”. The following review also contains repetition.</p></li>
<li><p>non-English reviews</p></li>
</ul>
<div id="results" class="section level2 tabset">
<h2>Results</h2>
<div id="repeated-reviews" class="section level3">
<h3>Repeated reviews</h3>
<p>“While the game itself is great, really relaxing and gorgeous, i can’t ignore one thing that ruins the whole experience for me and a lot of other people as seen by the different user reviews.That thing is that you only have 1 island per console. This decision limits to one person being able to enjoy the full experience. It also nukes any creative control of the island, since you haveWhile the game itself is great, really relaxing and gorgeous, i can’t ignore one thing that ruins the whole experience for me and a lot of other people as seen by the different user reviews.That thing is that you only have 1 island per console. This decision limits to one person being able to enjoy the full experience. It also nukes any creative control of the island, since you have the other usershouse and furniture. I hope nintendo can soon fix this big issue, because for now, this killed any intentions i had to play the game.… Expand”</p>
</div>
<div id="incomplete-reviews-because-they-are-too-long" class="section level3">
<h3>Incomplete reviews because they are too long</h3>
<p>“One island per console is a design decision that is, at best, in poor taste, and at worst, straight-up predatory behavior.Per console, only one player gets to experience the game at its fullest. The other players see less dialogue, experience less events, and are locked out entirely from certain parts of the game.No matter how good a game is, I cannot stand behind a company thatOne island per console is a design decision that is, at best, in poor taste, and at worst, straight-up predatory behavior.Per console, only one player gets to experience the game at its fullest. The other players see less dialogue, experience less events, and are locked out entirely from certain parts of the game.No matter how good a game is, I cannot stand behind a company that sees fit to make such decisions.… Expand”</p>
</div>
<div id="non-english-reviews" class="section level3">
<h3>Non-English reviews</h3>
<p>“Una sola isla , es un asco . No puedes seguir avanzando, solo te queda recoger madera”</p>
</div>
</div>
<div id="section" class="section level2">
<h2></h2>
<p>I use regular expressions to remove reptitions and “Expand” at the end. Repetitions happen when the review is long, and the repetition part often takes up 4 to 5 lines (here I use 350 or more characters to indicate the repetition part).</p>
<p><code>clr::detect_language</code> is used to exclude non-English text. This a R wrapper around Google’s Compact Language Detector 3, a neural network model for language identification . There will be misclassifications, though. As the proportion of exclusion is fairly low, we’re OK.</p>
<pre class="r"><code>library(cld3)
reviews %&gt;% 
  mutate(language = detect_language(text)) %&gt;% 
  count(language, sort = TRUE)
#&gt; # A tibble: 11 x 2
#&gt;    language     n
#&gt;    &lt;chr&gt;    &lt;int&gt;
#&gt;  1 en        1394
#&gt;  2 es          48
#&gt;  3 ru           7
#&gt;  4 it           6
#&gt;  5 fr           5
#&gt;  6 pt           5
#&gt;  7 de           3
#&gt;  8 &lt;NA&gt;         2
#&gt;  9 ja           1
#&gt; 10 pl           1
#&gt; 11 th           1</code></pre>
<pre class="r"><code>reviews_en &lt;- reviews %&gt;% 
  filter(detect_language(text) == &quot;en&quot;)


repetition_clean &lt;- reviews %&gt;% 
  filter(str_detect(text, &quot;(.{350,})\\1.+&quot;)) %&gt;% 
  mutate(text = str_replace(text, &quot;(.{350,})\\1(.+)Expand$&quot;, &quot;\\1\\2&quot;))

reviews_clean &lt;- anti_join(reviews_en, repetition_clean, 
                           by = c(&quot;user_name&quot; = &quot;user_name&quot;)) %&gt;% 
  bind_rows(repetition_clean)

# draw some sample reviews
reviews_clean %&gt;% 
  sample_n(3) %&gt;% 
  pull(text)
#&gt; [1] &quot;I am currently playing this game single player however I feel compelled to review this game based on the multiplayer experience. The decision to lock the game to one island per console is nothing short of a cash grab. I am a long time Nintendo fan since I received a SNES for Christmas as a child but this behavior disgusts me and I am reluctant to spend any more money with this company if they do not address this problem. Nintendo consoles have always been family focused machines that encourage multiplayer and this seems to go against everything they have ever done to date.Sadly they have likely already sold enough units to cover costs and will simply ignore the outrage from their customers.… &quot;
#&gt; [2] &quot;This game is excellent, I can&#39;t stop playing it, it&#39;s fun and has so many thing to do that I can spend hours and hours playing it and still don&#39;t get tiredBest game that I have played in a while&quot;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
#&gt; [3] &quot;Cast: 6/10Story: 6/10Fun: 9/10Gameplay: 8/10Recommended----------------------&quot;</code></pre>
<p>We can examine how this cleaning process works by comparing the distribution of review length, before and after. The cleaning should reduce the amount of medium long and long reviews, in exchange for shorter ones.</p>
<pre class="r"><code>reviews %&gt;%
  transmute(length = str_length(text),
            type = &quot;before&quot;) %&gt;% 
  bind_rows(reviews_clean %&gt;%
              transmute(length = str_length(text), type = &quot;after&quot;)) %&gt;%
  ggplot() + 
  geom_density(aes(length, fill = type), alpha = 0.2) + 
  scale_fill_discrete(name = NULL) + 
  labs(title = &quot;Distribution of review length before and after cleaning&quot;,
       x = NULL,
       y = NULL)</code></pre>
<p><img src="/post/2020-05-07-analyzing-animal-crossing-reviews/index_files/figure-html/unnamed-chunk-8-1.png" width="768" /></p>
</div>
</div>
<div id="sentiment-analysis-of-user-reviews" class="section level1">
<h1>Sentiment analysis of user reviews</h1>
</div>
<div id="predictive-modeling-for-grades-with-user-reviews" class="section level1">
<h1>Predictive modeling for grades with user reviews</h1>
<pre class="r"><code>
reviews %&gt;% 
  transmute(rating = case_when(
    grade &lt;= 4 ~ &quot;low&quot;,
    grade &gt; 4 &amp; grade &lt;= 8 ~ &quot;medium&quot;,
    grade &gt; 8 ~ &quot;high&quot;,
  ),
  text) %&gt;% 
  unnest_tokens(line, text, token = &quot;lines&quot;) 
#&gt; # A tibble: 1,473 x 2
#&gt;    rating line                                                                  
#&gt;    &lt;chr&gt;  &lt;chr&gt;                                                                 
#&gt;  1 high   cant stop playing!                                                    
#&gt;  2 high   as a first timer to the animal crossing series, it was a bit hard to ~
#&gt;  3 high   this is my first animal crossing game i’ve ever played. i am seriousl~
#&gt;  4 high   i like it so far. unfair to rate the game a 0 because of a poor desig~
#&gt;  5 high   this game is absolutely amazing as a constant side game for one&#39;s day~
#&gt;  6 high   probably the best animal crossing has ever been, and to fans of the s~
#&gt;  7 high   an amazing game and the best ac yet! if you don’t understand there is~
#&gt;  8 high   an absolutely awesome addition to the franchise. everything about thi~
#&gt;  9 high   this review contains spoilers, click expand to view.                 ~
#&gt; 10 high   there are no words to describe the flawlessly, gorgeous graphics and ~
#&gt; # ... with 1,463 more rows</code></pre>
</div>
