<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 readr | R for data science: tidyverse and beyond</title>
  <meta name="description" content="3 readr | R for data science: tidyverse and beyond" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="3 readr | R for data science: tidyverse and beyond" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/rfordatascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 readr | R for data science: tidyverse and beyond" />
  
  
  

<meta name="author" content="Maxine" />


<meta name="date" content="2020-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tibble.html"/>
<link rel="next" href="lubridate.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R4DS: tidyverse and beyond</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a></li>
<li class="part"><span><b>I R for data science</b></span></li>
<li class="chapter" data-level="1" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>1</b> dplyr</a><ul>
<li class="chapter" data-level="1.1" data-path="dplyr.html"><a href="dplyr.html#个数据转换核心函数"><i class="fa fa-check"></i><b>1.1</b> 5个数据转换核心函数</a></li>
<li class="chapter" data-level="1.2" data-path="dplyr.html"><a href="dplyr.html#filter筛选行"><i class="fa fa-check"></i><b>1.2</b> <code>filter()</code>筛选行</a><ul>
<li class="chapter" data-level="1.2.1" data-path="dplyr.html"><a href="dplyr.html#运算符"><i class="fa fa-check"></i><b>1.2.1</b> 运算符</a></li>
<li class="chapter" data-level="1.2.2" data-path="dplyr.html"><a href="dplyr.html#缺失值"><i class="fa fa-check"></i><b>1.2.2</b> 缺失值</a></li>
<li class="chapter" data-level="1.2.3" data-path="dplyr.html"><a href="dplyr.html#练习"><i class="fa fa-check"></i><b>1.2.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="dplyr.html"><a href="dplyr.html#arrange-排列行"><i class="fa fa-check"></i><b>1.3</b> <code>arrange()</code> 排列行</a><ul>
<li class="chapter" data-level="1.3.1" data-path="dplyr.html"><a href="dplyr.html#slice"><i class="fa fa-check"></i><b>1.3.1</b> <code>slice()</code></a></li>
<li class="chapter" data-level="1.3.2" data-path="dplyr.html"><a href="dplyr.html#练习-1"><i class="fa fa-check"></i><b>1.3.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="dplyr.html"><a href="dplyr.html#使用select选择列"><i class="fa fa-check"></i><b>1.4</b> 使用<code>select()</code>选择列</a><ul>
<li class="chapter" data-level="1.4.1" data-path="dplyr.html"><a href="dplyr.html#练习-2"><i class="fa fa-check"></i><b>1.4.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="dplyr.html"><a href="dplyr.html#mutate-创建变量"><i class="fa fa-check"></i><b>1.5</b> <code>mutate()</code> 创建变量</a><ul>
<li class="chapter" data-level="1.5.1" data-path="dplyr.html"><a href="dplyr.html#常用创建函数using-creation-functions"><i class="fa fa-check"></i><b>1.5.1</b> 常用创建函数（Using creation functions）</a></li>
<li class="chapter" data-level="1.5.2" data-path="dplyr.html"><a href="dplyr.html#练习-3"><i class="fa fa-check"></i><b>1.5.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="dplyr.html"><a href="dplyr.html#使用summarize进行分组摘要"><i class="fa fa-check"></i><b>1.6</b> 使用<code>summarize()</code>进行分组摘要</a><ul>
<li class="chapter" data-level="1.6.1" data-path="dplyr.html"><a href="dplyr.html#缺失值-1"><i class="fa fa-check"></i><b>1.6.1</b> 缺失值</a></li>
<li class="chapter" data-level="1.6.2" data-path="dplyr.html"><a href="dplyr.html#计数函数"><i class="fa fa-check"></i><b>1.6.2</b> 计数函数</a></li>
<li class="chapter" data-level="1.6.3" data-path="dplyr.html"><a href="dplyr.html#逻辑值的计数和比例sumx-10-和-meany-0"><i class="fa fa-check"></i><b>1.6.3</b> 逻辑值的计数和比例:<code>sum(x &gt; 10) 和 mean(y == 0)</code></a></li>
<li class="chapter" data-level="1.6.4" data-path="dplyr.html"><a href="dplyr.html#其他常用的摘要函数"><i class="fa fa-check"></i><b>1.6.4</b> 其他常用的摘要函数</a></li>
<li class="chapter" data-level="1.6.5" data-path="dplyr.html"><a href="dplyr.html#多个分组变量的消耗"><i class="fa fa-check"></i><b>1.6.5</b> 多个分组变量的消耗</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="dplyr.html"><a href="dplyr.html#group_by-结合其他函数"><i class="fa fa-check"></i><b>1.7</b> <code>group_by()</code> 结合其他函数</a></li>
<li class="chapter" data-level="1.8" data-path="dplyr.html"><a href="dplyr.html#练习-4"><i class="fa fa-check"></i><b>1.8</b> 练习</a></li>
<li class="chapter" data-level="1.9" data-path="dplyr.html"><a href="dplyr.html#作用域"><i class="fa fa-check"></i><b>1.9</b> 作用域</a><ul>
<li class="chapter" data-level="1.9.1" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>1.9.1</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="1.9.2" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>1.9.2</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="1.9.3" data-path="dplyr.html"><a href="dplyr.html#summarize"><i class="fa fa-check"></i><b>1.9.3</b> <code>summarize()</code></a></li>
<li class="chapter" data-level="1.9.4" data-path="dplyr.html"><a href="dplyr.html#dance"><i class="fa fa-check"></i><b>1.9.4</b> dance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>2</b> tibble</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble.html"><a href="tibble.html#tibble-intro"><i class="fa fa-check"></i><b>2.1</b> 简介</a></li>
<li class="chapter" data-level="2.2" data-path="tibble.html"><a href="tibble.html#tibble-data.frame"><i class="fa fa-check"></i><b>2.2</b> 对比 tibble 和 data.frame</a><ul>
<li class="chapter" data-level="2.2.1" data-path="tibble.html"><a href="tibble.html#创建"><i class="fa fa-check"></i><b>2.2.1</b> 创建</a></li>
<li class="chapter" data-level="2.2.2" data-path="tibble.html"><a href="tibble.html#打印"><i class="fa fa-check"></i><b>2.2.2</b> 打印</a></li>
<li class="chapter" data-level="2.2.3" data-path="tibble.html"><a href="tibble.html#取子集"><i class="fa fa-check"></i><b>2.2.3</b> 取子集</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="tibble.html"><a href="tibble.html#tibble-exercise"><i class="fa fa-check"></i><b>2.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="readr.html"><a href="readr.html"><i class="fa fa-check"></i><b>3</b> readr</a><ul>
<li class="chapter" data-level="3.1" data-path="readr.html"><a href="readr.html#base-r-中的数据读取"><i class="fa fa-check"></i><b>3.1</b> base R 中的数据读取</a></li>
<li class="chapter" data-level="3.2" data-path="readr.html"><a href="readr.html#readr-简介"><i class="fa fa-check"></i><b>3.2</b> readr 简介</a><ul>
<li class="chapter" data-level="3.2.1" data-path="readr.html"><a href="readr.html#写入文件"><i class="fa fa-check"></i><b>3.2.1</b> 写入文件</a></li>
<li class="chapter" data-level="3.2.2" data-path="readr.html"><a href="readr.html#练习-5"><i class="fa fa-check"></i><b>3.2.2</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="readr.html"><a href="readr.html#解析向量parsing-a-vector"><i class="fa fa-check"></i><b>3.3</b> 解析向量(Parsing a vector)</a><ul>
<li class="chapter" data-level="3.3.1" data-path="readr.html"><a href="readr.html#数值"><i class="fa fa-check"></i><b>3.3.1</b> 数值</a></li>
<li class="chapter" data-level="3.3.2" data-path="readr.html"><a href="readr.html#字符串"><i class="fa fa-check"></i><b>3.3.2</b> 字符串</a></li>
<li class="chapter" data-level="3.3.3" data-path="readr.html"><a href="readr.html#因子"><i class="fa fa-check"></i><b>3.3.3</b> 因子</a></li>
<li class="chapter" data-level="3.3.4" data-path="readr.html"><a href="readr.html#日期时间日期时间"><i class="fa fa-check"></i><b>3.3.4</b> 日期时间、日期、时间</a></li>
<li class="chapter" data-level="3.3.5" data-path="readr.html"><a href="readr.html#练习-6"><i class="fa fa-check"></i><b>3.3.5</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="readr.html"><a href="readr.html#解析文件"><i class="fa fa-check"></i><b>3.4</b> 解析文件</a><ul>
<li class="chapter" data-level="3.4.1" data-path="readr.html"><a href="readr.html#解析策略strategies"><i class="fa fa-check"></i><b>3.4.1</b> 解析策略(strategies)</a></li>
<li class="chapter" data-level="3.4.2" data-path="readr.html"><a href="readr.html#可能遇到的问题"><i class="fa fa-check"></i><b>3.4.2</b> 可能遇到的问题</a></li>
<li class="chapter" data-level="3.4.3" data-path="readr.html"><a href="readr.html#其他技巧"><i class="fa fa-check"></i><b>3.4.3</b> 其他技巧</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="readr.html"><a href="readr.html#readxl"><i class="fa fa-check"></i><b>3.5</b> readxl</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lubridate.html"><a href="lubridate.html"><i class="fa fa-check"></i><b>4</b> lubridate</a><ul>
<li class="chapter" data-level="4.1" data-path="lubridate.html"><a href="lubridate.html#创建日期和时间"><i class="fa fa-check"></i><b>4.1</b> 创建日期和时间</a><ul>
<li class="chapter" data-level="4.1.1" data-path="lubridate.html"><a href="lubridate.html#通过字符串创建"><i class="fa fa-check"></i><b>4.1.1</b> 通过字符串创建</a></li>
<li class="chapter" data-level="4.1.2" data-path="lubridate.html"><a href="lubridate.html#通过各个成分创建"><i class="fa fa-check"></i><b>4.1.2</b> 通过各个成分创建</a></li>
<li class="chapter" data-level="4.1.3" data-path="lubridate.html"><a href="lubridate.html#日期时间型和日期型数据的相互转换"><i class="fa fa-check"></i><b>4.1.3</b> 日期时间型和日期型数据的相互转换</a></li>
<li class="chapter" data-level="4.1.4" data-path="lubridate.html"><a href="lubridate.html#练习-7"><i class="fa fa-check"></i><b>4.1.4</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lubridate.html"><a href="lubridate.html#日期时间成分"><i class="fa fa-check"></i><b>4.2</b> 日期时间成分</a><ul>
<li class="chapter" data-level="4.2.1" data-path="lubridate.html"><a href="lubridate.html#获取成分"><i class="fa fa-check"></i><b>4.2.1</b> 获取成分</a></li>
<li class="chapter" data-level="4.2.2" data-path="lubridate.html"><a href="lubridate.html#舍入rouding"><i class="fa fa-check"></i><b>4.2.2</b> 舍入（Rouding）</a></li>
<li class="chapter" data-level="4.2.3" data-path="lubridate.html"><a href="lubridate.html#设置成分"><i class="fa fa-check"></i><b>4.2.3</b> 设置成分</a></li>
<li class="chapter" data-level="4.2.4" data-path="lubridate.html"><a href="lubridate.html#练习-8"><i class="fa fa-check"></i><b>4.2.4</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="lubridate.html"><a href="lubridate.html#时间间隔time-span"><i class="fa fa-check"></i><b>4.3</b> 时间间隔（Time Span）</a><ul>
<li class="chapter" data-level="4.3.1" data-path="lubridate.html"><a href="lubridate.html#时期-durations"><i class="fa fa-check"></i><b>4.3.1</b> 时期 Durations</a></li>
<li class="chapter" data-level="4.3.2" data-path="lubridate.html"><a href="lubridate.html#阶段-periods"><i class="fa fa-check"></i><b>4.3.2</b> 阶段 Periods</a></li>
<li class="chapter" data-level="4.3.3" data-path="lubridate.html"><a href="lubridate.html#区间-intervals"><i class="fa fa-check"></i><b>4.3.3</b> 区间 Intervals</a></li>
<li class="chapter" data-level="4.3.4" data-path="lubridate.html"><a href="lubridate.html#小结"><i class="fa fa-check"></i><b>4.3.4</b> 小结</a></li>
<li class="chapter" data-level="4.3.5" data-path="lubridate.html"><a href="lubridate.html#练习-9"><i class="fa fa-check"></i><b>4.3.5</b> 练习</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="forcats.html"><a href="forcats.html"><i class="fa fa-check"></i><b>5</b> forcats</a><ul>
<li class="chapter" data-level="5.1" data-path="forcats.html"><a href="forcats.html#简介"><i class="fa fa-check"></i><b>5.1</b> 简介</a><ul>
<li class="chapter" data-level="5.1.1" data-path="forcats.html"><a href="forcats.html#因子基础"><i class="fa fa-check"></i><b>5.1.1</b> 因子基础</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="forcats.html"><a href="forcats.html#排序"><i class="fa fa-check"></i><b>5.2</b> 排序</a><ul>
<li class="chapter" data-level="5.2.1" data-path="forcats.html"><a href="forcats.html#按照水平的频次排序"><i class="fa fa-check"></i><b>5.2.1</b> 按照水平的频次排序</a></li>
<li class="chapter" data-level="5.2.2" data-path="forcats.html"><a href="forcats.html#按照其他变量排序"><i class="fa fa-check"></i><b>5.2.2</b> 按照其他变量排序</a></li>
<li class="chapter" data-level="5.2.3" data-path="forcats.html"><a href="forcats.html#人工指定顺序"><i class="fa fa-check"></i><b>5.2.3</b> 人工指定顺序</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="forcats.html"><a href="forcats.html#改变水平个数"><i class="fa fa-check"></i><b>5.3</b> 改变水平个数</a><ul>
<li class="chapter" data-level="5.3.1" data-path="forcats.html"><a href="forcats.html#合并水平"><i class="fa fa-check"></i><b>5.3.1</b> 合并水平</a></li>
<li class="chapter" data-level="5.3.2" data-path="forcats.html"><a href="forcats.html#增加水平"><i class="fa fa-check"></i><b>5.3.2</b> 增加水平</a></li>
<li class="chapter" data-level="5.3.3" data-path="forcats.html"><a href="forcats.html#舍弃水平dropping-unused-levels"><i class="fa fa-check"></i><b>5.3.3</b> 舍弃水平(Dropping unused levels)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="forcats.html"><a href="forcats.html#编码"><i class="fa fa-check"></i><b>5.4</b> 编码</a><ul>
<li class="chapter" data-level="5.4.1" data-path="forcats.html"><a href="forcats.html#练习-10"><i class="fa fa-check"></i><b>5.4.1</b> 练习：</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="forcats.html"><a href="forcats.html#合并因子"><i class="fa fa-check"></i><b>5.5</b> 合并因子</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tidyr.html"><a href="tidyr.html"><i class="fa fa-check"></i><b>6</b> tidyr</a><ul>
<li class="chapter" data-level="6.1" data-path="tidyr.html"><a href="tidyr.html#tidyr-intro"><i class="fa fa-check"></i><b>6.1</b> 简介</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tidyr.html"><a href="tidyr.html#练习-11"><i class="fa fa-check"></i><b>6.1.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tidyr.html"><a href="tidyr.html#spread和gather"><i class="fa fa-check"></i><b>6.2</b> <code>spread()</code>和<code>gather()</code></a><ul>
<li class="chapter" data-level="6.2.1" data-path="tidyr.html"><a href="tidyr.html#gather"><i class="fa fa-check"></i><b>6.2.1</b> <code>gather()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="tidyr.html"><a href="tidyr.html#spread"><i class="fa fa-check"></i><b>6.2.2</b> <code>spread()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="tidyr.html"><a href="tidyr.html#练习-12"><i class="fa fa-check"></i><b>6.2.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="tidyr.html"><a href="tidyr.html#separate和untie"><i class="fa fa-check"></i><b>6.3</b> <code>separate()</code>和<code>untie()</code></a><ul>
<li class="chapter" data-level="6.3.1" data-path="tidyr.html"><a href="tidyr.html#separate"><i class="fa fa-check"></i><b>6.3.1</b> <code>separate()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="tidyr.html"><a href="tidyr.html#unite"><i class="fa fa-check"></i><b>6.3.2</b> <code>unite()</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="tidyr.html"><a href="tidyr.html#练习-13"><i class="fa fa-check"></i><b>6.3.3</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="tidyr.html"><a href="tidyr.html#tidyr-missing"><i class="fa fa-check"></i><b>6.4</b> 缺失值</a></li>
<li class="chapter" data-level="6.5" data-path="tidyr.html"><a href="tidyr.html#case-study"><i class="fa fa-check"></i><b>6.5</b> Case Study</a><ul>
<li class="chapter" data-level="6.5.1" data-path="tidyr.html"><a href="tidyr.html#练习-14"><i class="fa fa-check"></i><b>6.5.1</b> 练习</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tidyr.html"><a href="tidyr.html#non-tidy"><i class="fa fa-check"></i><b>6.6</b> 拓展：None-tidy data</a></li>
<li class="chapter" data-level="6.7" data-path="tidyr.html"><a href="tidyr.html#tidyr-1.0.0"><i class="fa fa-check"></i><b>6.7</b> <code>tidyr 1.0.0</code></a><ul>
<li class="chapter" data-level="6.7.1" data-path="tidyr.html"><a href="tidyr.html#pivot_longer-和-pivot_wider"><i class="fa fa-check"></i><b>6.7.1</b> <code>pivot_longer</code> 和 <code>pivot_wider</code></a></li>
<li class="chapter" data-level="6.7.2" data-path="tidyr.html"><a href="tidyr.html#pivot_wider"><i class="fa fa-check"></i><b>6.7.2</b> <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>7</b> relational data</a><ul>
<li class="chapter" data-level="7.1" data-path="relational-data.html"><a href="relational-data.html#introduction"><i class="fa fa-check"></i><b>7.1</b> introduction</a></li>
<li class="chapter" data-level="7.2" data-path="relational-data.html"><a href="relational-data.html#mutating-joins"><i class="fa fa-check"></i><b>7.2</b> mutating joins</a></li>
<li class="chapter" data-level="7.3" data-path="relational-data.html"><a href="relational-data.html#filtering-join"><i class="fa fa-check"></i><b>7.3</b> filtering join</a></li>
<li class="chapter" data-level="7.4" data-path="relational-data.html"><a href="relational-data.html#fuzzy-join"><i class="fa fa-check"></i><b>7.4</b> fuzzy join</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="broom.html"><a href="broom.html"><i class="fa fa-check"></i><b>8</b> broom</a></li>
<li class="chapter" data-level="9" data-path="purrr.html"><a href="purrr.html"><i class="fa fa-check"></i><b>9</b> purrr</a><ul>
<li class="chapter" data-level="9.1" data-path="purrr.html"><a href="purrr.html#map-family"><i class="fa fa-check"></i><b>9.1</b> <code>map()</code> family</a></li>
<li class="chapter" data-level="9.2" data-path="purrr.html"><a href="purrr.html#producing-atomic-vectors"><i class="fa fa-check"></i><b>9.2</b> Producing atomic vectors</a><ul>
<li class="chapter" data-level="9.2.1" data-path="purrr.html"><a href="purrr.html#purrr-style-anonymous-functions"><i class="fa fa-check"></i><b>9.2.1</b> purrr-style anonymous functions</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="purrr.html"><a href="purrr.html#predicate-functions"><i class="fa fa-check"></i><b>9.3</b> Predicate functions</a><ul>
<li class="chapter" data-level="9.3.1" data-path="purrr.html"><a href="purrr.html#basics"><i class="fa fa-check"></i><b>9.3.1</b> Basics</a></li>
<li class="chapter" data-level="9.3.2" data-path="purrr.html"><a href="purrr.html#map-variants"><i class="fa fa-check"></i><b>9.3.2</b> Map variants</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="purrr.html"><a href="purrr.html#group_"><i class="fa fa-check"></i><b>9.4</b> group_</a><ul>
<li class="chapter" data-level="9.4.1" data-path="purrr.html"><a href="purrr.html#group_mapgroup_modify"><i class="fa fa-check"></i><b>9.4.1</b> group_map、group_modify</a></li>
<li class="chapter" data-level="9.4.2" data-path="purrr.html"><a href="purrr.html#group_splitgroup_keysgroup_data"><i class="fa fa-check"></i><b>9.4.2</b> group_split、group_keys、group_data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Importing</b></span></li>
<li class="chapter" data-level="10" data-path="vroom.html"><a href="vroom.html"><i class="fa fa-check"></i><b>10</b> vroom</a></li>
<li class="chapter" data-level="11" data-path="data-apis.html"><a href="data-apis.html"><i class="fa fa-check"></i><b>11</b> Data APIs</a><ul>
<li class="chapter" data-level="11.1" data-path="data-apis.html"><a href="data-apis.html#wdi"><i class="fa fa-check"></i><b>11.1</b> WDI</a><ul>
<li class="chapter" data-level="11.1.1" data-path="data-apis.html"><a href="data-apis.html#wdisearch"><i class="fa fa-check"></i><b>11.1.1</b> <code>WDIsearch()</code></a></li>
<li class="chapter" data-level="11.1.2" data-path="data-apis.html"><a href="data-apis.html#wdi-1"><i class="fa fa-check"></i><b>11.1.2</b> <code>WDI</code></a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="data-apis.html"><a href="data-apis.html#ipumsr"><i class="fa fa-check"></i><b>11.2</b> ipumsr</a></li>
</ul></li>
<li class="part"><span><b>III Exploring and Wrangling</b></span></li>
<li class="chapter" data-level="12" data-path="data-table.html"><a href="data-table.html"><i class="fa fa-check"></i><b>12</b> data.table</a><ul>
<li class="chapter" data-level="12.1" data-path="data-table.html"><a href="data-table.html#dtplyr"><i class="fa fa-check"></i><b>12.1</b> dtplyr</a></li>
<li class="chapter" data-level="12.2" data-path="data-table.html"><a href="data-table.html#maditr"><i class="fa fa-check"></i><b>12.2</b> maditr</a></li>
<li class="chapter" data-level="12.3" data-path="data-table.html"><a href="data-table.html#tidyfast"><i class="fa fa-check"></i><b>12.3</b> tidyfast</a></li>
<li class="chapter" data-level="12.4" data-path="data-table.html"><a href="data-table.html#disk.frame"><i class="fa fa-check"></i><b>12.4</b> disk.frame</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rowwise-operation.html"><a href="rowwise-operation.html"><i class="fa fa-check"></i><b>13</b> rowwise operation</a><ul>
<li class="chapter" data-level="13.1" data-path="rowwise-operation.html"><a href="rowwise-operation.html#do-rowwise"><i class="fa fa-check"></i><b>13.1</b> do() + rowwise()</a></li>
<li class="chapter" data-level="13.2" data-path="rowwise-operation.html"><a href="rowwise-operation.html#rap"><i class="fa fa-check"></i><b>13.2</b> rap</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="data-summary.html"><a href="data-summary.html"><i class="fa fa-check"></i><b>14</b> Data Summary</a><ul>
<li class="chapter" data-level="14.1" data-path="data-summary.html"><a href="data-summary.html#skimr"><i class="fa fa-check"></i><b>14.1</b> skimr</a></li>
<li class="chapter" data-level="14.2" data-path="data-summary.html"><a href="data-summary.html#visdat"><i class="fa fa-check"></i><b>14.2</b> visdat</a></li>
<li class="chapter" data-level="14.3" data-path="data-summary.html"><a href="data-summary.html#summarytools"><i class="fa fa-check"></i><b>14.3</b> summarytools</a><ul>
<li class="chapter" data-level="14.3.1" data-path="data-summary.html"><a href="data-summary.html#freq"><i class="fa fa-check"></i><b>14.3.1</b> <code>freq</code></a></li>
<li class="chapter" data-level="14.3.2" data-path="data-summary.html"><a href="data-summary.html#descr"><i class="fa fa-check"></i><b>14.3.2</b> <code>descr()</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Cleaning and Tidying</b></span></li>
<li class="chapter" data-level="15" data-path="janitor.html"><a href="janitor.html"><i class="fa fa-check"></i><b>15</b> Janitor</a><ul>
<li class="chapter" data-level="15.1" data-path="janitor.html"><a href="janitor.html#qingxi"><i class="fa fa-check"></i><b>15.1</b> 清洗</a><ul>
<li class="chapter" data-level="15.1.1" data-path="janitor.html"><a href="janitor.html#clean_names"><i class="fa fa-check"></i><b>15.1.1</b> <code>clean_names</code></a></li>
<li class="chapter" data-level="15.1.2" data-path="janitor.html"><a href="janitor.html#compare_df_cols"><i class="fa fa-check"></i><b>15.1.2</b> <code>compare_df_cols</code></a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="janitor.html"><a href="janitor.html#tansuo"><i class="fa fa-check"></i><b>15.2</b> 探索</a><ul>
<li class="chapter" data-level="15.2.1" data-path="janitor.html"><a href="janitor.html#tabyl"><i class="fa fa-check"></i><b>15.2.1</b> <code>tabyl</code></a></li>
<li class="chapter" data-level="15.2.2" data-path="janitor.html"><a href="janitor.html#get_dupes"><i class="fa fa-check"></i><b>15.2.2</b> <code>get_dupes</code></a></li>
<li class="chapter" data-level="15.2.3" data-path="janitor.html"><a href="janitor.html#remove_"><i class="fa fa-check"></i><b>15.2.3</b> <code>remove_</code></a></li>
<li class="chapter" data-level="15.2.4" data-path="janitor.html"><a href="janitor.html#round_half_up"><i class="fa fa-check"></i><b>15.2.4</b> <code>round_half_up</code></a></li>
<li class="chapter" data-level="15.2.5" data-path="janitor.html"><a href="janitor.html#excel_numeric_to_date"><i class="fa fa-check"></i><b>15.2.5</b> <code>excel_numeric_to_date</code></a></li>
<li class="chapter" data-level="15.2.6" data-path="janitor.html"><a href="janitor.html#top_levels"><i class="fa fa-check"></i><b>15.2.6</b> <code>top_levels</code></a></li>
<li class="chapter" data-level="15.2.7" data-path="janitor.html"><a href="janitor.html#row_to_names"><i class="fa fa-check"></i><b>15.2.7</b> <code>row_to_names</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>16</b> 处理缺失值</a><ul>
<li class="chapter" data-level="16.1" data-path="missing-values.html"><a href="missing-values.html#explore-missing"><i class="fa fa-check"></i><b>16.1</b> 探索</a></li>
<li class="chapter" data-level="16.2" data-path="missing-values.html"><a href="missing-values.html#fill-missing"><i class="fa fa-check"></i><b>16.2</b> 填充</a></li>
</ul></li>
<li class="part"><span><b>V Modelling</b></span></li>
<li class="chapter" data-level="17" data-path="tidymodels.html"><a href="tidymodels.html"><i class="fa fa-check"></i><b>17</b> tidymodels</a></li>
<li class="chapter" data-level="18" data-path="caret.html"><a href="caret.html"><i class="fa fa-check"></i><b>18</b> caret</a></li>
<li class="chapter" data-level="19" data-path="vtreat.html"><a href="vtreat.html"><i class="fa fa-check"></i><b>19</b> vtreat</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for data science: tidyverse and beyond</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="readr" class="section level1">
<h1><span class="header-section-number">3</span> readr</h1>
<div id="base-r-中的数据读取" class="section level2">
<h2><span class="header-section-number">3.1</span> base R 中的数据读取</h2>
<p>base R中有 3 个最主要的数据导入函数：</p>
<table>
<colgroup>
<col width="55%" />
<col width="44%" />
</colgroup>
<thead>
<tr class="header">
<th>函数</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>read.csv()</code></td>
<td>读取以逗号分隔的文件(<code>sep = ",", header = T</code>)</td>
</tr>
<tr class="even">
<td><code>read.delim()</code></td>
<td>读取以制表符分隔的文件(<code>sep = "\t", header = T</code>)</td>
</tr>
<tr class="odd">
<td><code>read.table()</code></td>
<td>读取其他一般性的文件，默认添加表头(<code>sep = "", header = F</code>)。<code>read.csv()</code>和<code>read.delim()</code>可以看做<code>read.table()</code>针对于特定情况的封装。</td>
</tr>
</tbody>
</table>
<p>用于导入数据的函数一般都有大量的参数，上述的三个函数中，比较重要的参数有：</p>
<ul>
<li><code>dec</code>: 指定文件中用于表示小数点的符号，很多文件中可能会用<code>;</code>或者<code>,</code>当做小数点，这时不仅需要设置<code>dec</code>，也要适当调整<code>sep</code>。<code>read.csv2()</code>和<code>read.delim2()</code>是对一些设置的封装。<br />
</li>
<li><code>col.names</code>用于在<code>header = F</code>时指定列名，默认情况下将被命名为“V1”、“V2”、···</li>
<li><code>row.names</code>用于设置行名，既可以传入一个向量直接指定，也可以选择数据中的某一列作为列名（用一个数字表明该列是第几列）<br />
</li>
<li><code>colClasses</code>:指定列的数据类型。特别是当你希望有些列作为因子，有些列作为字符串，这个参数便很有用。常用的类别有“numeric”,“factor”,“logical”,“character”。如果某列被指定为<code>"NULL"</code>，则该列不会被读入。<br />
</li>
<li><code>skip</code>指定读取数据前跳过的行数<br />
</li>
<li><code>nrows</code>读入的最大行数</li>
</ul>
<p>我们使用本地数据集<code>hotdogs.txt</code>简要说明这些函数的用法，它没有列名，且用空格分隔：</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="co">## 分别使用三个函数</span></a>
<a class="sourceLine" id="cb165-2" title="2">hotdogs1 &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;data/hotdogs.txt&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb165-3" title="3"><span class="kw">head</span>(hotdogs1)</a>
<a class="sourceLine" id="cb165-4" title="4"><span class="co">#&gt;     V1  V2  V3</span></a>
<a class="sourceLine" id="cb165-5" title="5"><span class="co">#&gt; 1 Beef 186 495</span></a>
<a class="sourceLine" id="cb165-6" title="6"><span class="co">#&gt; 2 Beef 181 477</span></a>
<a class="sourceLine" id="cb165-7" title="7"><span class="co">#&gt; 3 Beef 176 425</span></a>
<a class="sourceLine" id="cb165-8" title="8"><span class="co">#&gt; 4 Beef 149 322</span></a>
<a class="sourceLine" id="cb165-9" title="9"><span class="co">#&gt; 5 Beef 184 482</span></a>
<a class="sourceLine" id="cb165-10" title="10"><span class="co">#&gt; 6 Beef 190 587</span></a>
<a class="sourceLine" id="cb165-11" title="11"></a>
<a class="sourceLine" id="cb165-12" title="12">hotdogs2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/hotdogs.txt&quot;</span>,<span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,<span class="dt">header =</span> F)</a>
<a class="sourceLine" id="cb165-13" title="13"><span class="kw">head</span>(hotdogs2)</a>
<a class="sourceLine" id="cb165-14" title="14"><span class="co">#&gt;     V1  V2  V3</span></a>
<a class="sourceLine" id="cb165-15" title="15"><span class="co">#&gt; 1 Beef 186 495</span></a>
<a class="sourceLine" id="cb165-16" title="16"><span class="co">#&gt; 2 Beef 181 477</span></a>
<a class="sourceLine" id="cb165-17" title="17"><span class="co">#&gt; 3 Beef 176 425</span></a>
<a class="sourceLine" id="cb165-18" title="18"><span class="co">#&gt; 4 Beef 149 322</span></a>
<a class="sourceLine" id="cb165-19" title="19"><span class="co">#&gt; 5 Beef 184 482</span></a>
<a class="sourceLine" id="cb165-20" title="20"><span class="co">#&gt; 6 Beef 190 587</span></a>
<a class="sourceLine" id="cb165-21" title="21"></a>
<a class="sourceLine" id="cb165-22" title="22">hotdogs2 &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data/hotdogs.txt&quot;</span>,<span class="dt">header =</span> F)</a>
<a class="sourceLine" id="cb165-23" title="23"><span class="kw">head</span>(hotdogs2)</a>
<a class="sourceLine" id="cb165-24" title="24"><span class="co">#&gt;     V1  V2  V3</span></a>
<a class="sourceLine" id="cb165-25" title="25"><span class="co">#&gt; 1 Beef 186 495</span></a>
<a class="sourceLine" id="cb165-26" title="26"><span class="co">#&gt; 2 Beef 181 477</span></a>
<a class="sourceLine" id="cb165-27" title="27"><span class="co">#&gt; 3 Beef 176 425</span></a>
<a class="sourceLine" id="cb165-28" title="28"><span class="co">#&gt; 4 Beef 149 322</span></a>
<a class="sourceLine" id="cb165-29" title="29"><span class="co">#&gt; 5 Beef 184 482</span></a>
<a class="sourceLine" id="cb165-30" title="30"><span class="co">#&gt; 6 Beef 190 587</span></a></code></pre></div>
<p>设定 <code>col.names</code> 和 <code>colClasses</code>：</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1">hotdogs &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">hotdogs.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb166-2" title="2">                       <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;type&quot;</span>, <span class="st">&quot;calories&quot;</span>, <span class="st">&quot;sodium&quot;</span>),</a>
<a class="sourceLine" id="cb166-3" title="3">                       <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;factor&quot;</span>, <span class="st">&quot;NULL&quot;</span>, <span class="st">&quot;numeric&quot;</span>))</a>
<a class="sourceLine" id="cb166-4" title="4"><span class="kw">head</span>(hotdogs)</a>
<a class="sourceLine" id="cb166-5" title="5"><span class="co">#&gt;   type sodium</span></a>
<a class="sourceLine" id="cb166-6" title="6"><span class="co">#&gt; 1 Beef    495</span></a>
<a class="sourceLine" id="cb166-7" title="7"><span class="co">#&gt; 2 Beef    477</span></a>
<a class="sourceLine" id="cb166-8" title="8"><span class="co">#&gt; 3 Beef    425</span></a>
<a class="sourceLine" id="cb166-9" title="9"><span class="co">#&gt; 4 Beef    322</span></a>
<a class="sourceLine" id="cb166-10" title="10"><span class="co">#&gt; 5 Beef    482</span></a>
<a class="sourceLine" id="cb166-11" title="11"><span class="co">#&gt; 6 Beef    587</span></a></code></pre></div>
</div>
<div id="readr-简介" class="section level2">
<h2><span class="header-section-number">3.2</span> readr 简介</h2>
<p><img src="images/6.png" width="80%" /></p>
<p><strong>readr</strong> 是 tidyverse 的核心 R 包之一，作用是将平面数据(flat files)快速读取至 R 中，并转换为易用的 tibble 格式。相对于 base R 中有的数据读取函数，它有以下的优点：</p>
<ul>
<li>一般来说，它们比基础模块中的函数速度更快（约快 10 倍）。如果只考虑读取速度的话，还可以尝试使用第 <a href="data-table.html#data-table">12</a> 章中的 <code>fread()</code> 或第 <a href="vroom.html#vroom">10</a> 章中的 <code>vroom()</code><br />
</li>
<li>它们可以生成 <code>tibble</code>，而且不会将字符串向量转换为因子，不使用行名称，也不会随意改动列名称。这些都是使用 base R 时比较烦人的事情<br />
</li>
<li>它们更容易重复使用。base R 中的函数会继承操作系统的功能，并依赖环境变量，因此，可以在你的计算机上正常运行的代码未必适用于他人的计算机</li>
</ul>
<p><strong>主要函数有</strong>：</p>
<ul>
<li><code>read_csv()</code> 读取逗号分割文件、<code>read_csv2()</code> 读取分号分隔文件（这在用逗号表示小数点的国家非常普遍），<code>read_tsv()</code> 读取制表符分隔文件，<code>read_delim()</code>函数可以读取使用任意分隔符的文件(通过指定 <code>delim</code> 参数)<br />
</li>
<li><code>read_fwf()</code> 读取固定宽度的文件(fixed width file)。既可以使用 <code>fwf_width()</code> 函按照宽度来设定域，也可以使用 <code>fwf_positions()</code> 函数按照位置来设定域。<code>read_table()</code> 读取固定宽度文件的一种常用变体，其中使用空白字符来分隔各列</li>
</ul>
<p><strong>重要参数</strong>：</p>
<ul>
<li><code>delim</code> 指定分隔符<br />
</li>
<li><code>col_names = T</code>：以上的函数默认将第一行用作列名，如果设定<code>col_names = F</code>则列名为<code>X1</code>、<code>X2</code>、···。也可以指定一个字符向量。<br />
</li>
<li><code>col_types</code>用一个字符串指定各列的数据类型</li>
</ul>
<table>
<thead>
<tr class="header">
<th>字符</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>“i”</td>
<td>integer</td>
</tr>
<tr class="even">
<td>“d”</td>
<td>double</td>
</tr>
<tr class="odd">
<td>“c”</td>
<td>character</td>
</tr>
<tr class="even">
<td>“l”</td>
<td>logical</td>
</tr>
<tr class="odd">
<td>"_"</td>
<td>舍弃该列</td>
</tr>
</tbody>
</table>
<ul>
<li><code>n_max</code>最大读取行数<br />
</li>
<li><code>na</code>表明文件中缺失值的表示方法</li>
</ul>
<p>下面用一些例子演示<code>read_delim()</code>函数的用法，因为它是最一般的形式，一旦掌握它，我们就可将从中学到的经验轻松应用于<code>readr</code>的其他函数。</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="co">## column names </span></a>
<a class="sourceLine" id="cb167-2" title="2">properties &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;area&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;size&quot;</span>, <span class="st">&quot;storage&quot;</span>, <span class="st">&quot;method&quot;</span>,</a>
<a class="sourceLine" id="cb167-3" title="3">                <span class="st">&quot;texture&quot;</span>, <span class="st">&quot;flavor&quot;</span>, <span class="st">&quot;moistness&quot;</span>)</a>
<a class="sourceLine" id="cb167-4" title="4"></a>
<a class="sourceLine" id="cb167-5" title="5"><span class="co">## 文件中用制表符为分隔符</span></a>
<a class="sourceLine" id="cb167-6" title="6">potatoes &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">potatoes.txt&quot;</span>,<span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb167-7" title="7">                       <span class="dt">col_names =</span> properties)</a>
<a class="sourceLine" id="cb167-8" title="8"></a>
<a class="sourceLine" id="cb167-9" title="9">potatoes</a>
<a class="sourceLine" id="cb167-10" title="10"><span class="co">#&gt; # A tibble: 160 x 8</span></a>
<a class="sourceLine" id="cb167-11" title="11"><span class="co">#&gt;    area  temp  size storage method texture flavor moistness</span></a>
<a class="sourceLine" id="cb167-12" title="12"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb167-13" title="13"><span class="co">#&gt; 1     1     1     1       1      1     2.9    3.2       3  </span></a>
<a class="sourceLine" id="cb167-14" title="14"><span class="co">#&gt; 2     1     1     1       1      2     2.3    2.5       2.6</span></a>
<a class="sourceLine" id="cb167-15" title="15"><span class="co">#&gt; 3     1     1     1       1      3     2.5    2.8       2.8</span></a>
<a class="sourceLine" id="cb167-16" title="16"><span class="co">#&gt; 4     1     1     1       1      4     2.1    2.9       2.4</span></a>
<a class="sourceLine" id="cb167-17" title="17"><span class="co">#&gt; 5     1     1     1       1      5     1.9    2.8       2.2</span></a>
<a class="sourceLine" id="cb167-18" title="18"><span class="co">#&gt; 6     1     1     1       2      1     1.8    3         1.7</span></a>
<a class="sourceLine" id="cb167-19" title="19"><span class="co">#&gt; # … with 154 more rows</span></a></code></pre></div>
<p>当运行<code>readr</code>中的数据导入函数时，会打印出一份数据了说明，给出每个列的名称和类型。后面我们学习解析时，还会继续讨论这项功能。</p>
<p>通过<code>col_types</code>指定前五列为<code>integer</code>类型：</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1">properties &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;area&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;size&quot;</span>, <span class="st">&quot;storage&quot;</span>, <span class="st">&quot;method&quot;</span>,</a>
<a class="sourceLine" id="cb168-2" title="2">                <span class="st">&quot;texture&quot;</span>, <span class="st">&quot;flavor&quot;</span>, <span class="st">&quot;moistness&quot;</span>)</a>
<a class="sourceLine" id="cb168-3" title="3"></a>
<a class="sourceLine" id="cb168-4" title="4"></a>
<a class="sourceLine" id="cb168-5" title="5">potatoes &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">potatoes.txt&quot;</span>,<span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb168-6" title="6">                       <span class="dt">col_names =</span> properties,</a>
<a class="sourceLine" id="cb168-7" title="7">                       <span class="dt">col_types =</span> <span class="st">&quot;iiiiiddd&quot;</span>)</a>
<a class="sourceLine" id="cb168-8" title="8"></a>
<a class="sourceLine" id="cb168-9" title="9">potatoes</a>
<a class="sourceLine" id="cb168-10" title="10"><span class="co">#&gt; # A tibble: 160 x 8</span></a>
<a class="sourceLine" id="cb168-11" title="11"><span class="co">#&gt;    area  temp  size storage method texture flavor moistness</span></a>
<a class="sourceLine" id="cb168-12" title="12"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;  &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb168-13" title="13"><span class="co">#&gt; 1     1     1     1       1      1     2.9    3.2       3  </span></a>
<a class="sourceLine" id="cb168-14" title="14"><span class="co">#&gt; 2     1     1     1       1      2     2.3    2.5       2.6</span></a>
<a class="sourceLine" id="cb168-15" title="15"><span class="co">#&gt; 3     1     1     1       1      3     2.5    2.8       2.8</span></a>
<a class="sourceLine" id="cb168-16" title="16"><span class="co">#&gt; 4     1     1     1       1      4     2.1    2.9       2.4</span></a>
<a class="sourceLine" id="cb168-17" title="17"><span class="co">#&gt; 5     1     1     1       1      5     1.9    2.8       2.2</span></a>
<a class="sourceLine" id="cb168-18" title="18"><span class="co">#&gt; 6     1     1     1       2      1     1.8    3         1.7</span></a>
<a class="sourceLine" id="cb168-19" title="19"><span class="co">#&gt; # … with 154 more rows</span></a></code></pre></div>
<p>我们还可以创建一个行内 csv 文件。这种文件非常适合用<code>readr</code>进行实验，以及与他人分享可重现的例子：</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="kw">read_delim</span>(<span class="st">&quot;a, b, c</span></a>
<a class="sourceLine" id="cb169-2" title="2"><span class="st">           1, 2 , 3</span></a>
<a class="sourceLine" id="cb169-3" title="3"><span class="st">           4, 5, 6&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb169-4" title="4"><span class="co">#&gt; # A tibble: 2 x 3</span></a>
<a class="sourceLine" id="cb169-5" title="5"><span class="co">#&gt;   a              ` b`  ` c` </span></a>
<a class="sourceLine" id="cb169-6" title="6"><span class="co">#&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb169-7" title="7"><span class="co">#&gt; 1 &quot;           1&quot; &quot; 2 &quot; &quot; 3&quot; </span></a>
<a class="sourceLine" id="cb169-8" title="8"><span class="co">#&gt; 2 &quot;           4&quot; &quot; 5&quot;  &quot; 6&quot;</span></a></code></pre></div>
<p>有时文件开头会有几行元数据。可以使用 <code>skip = n</code> 来跳过前 n 行；或者使用 <code>comment = "#"</code> 丢弃所有以 # 开头的行：</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1"><span class="kw">read_delim</span>(<span class="st">&quot;The first line metadata</span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="st">         The second line of metadata</span></a>
<a class="sourceLine" id="cb170-3" title="3"><span class="st">         x,y,z</span></a>
<a class="sourceLine" id="cb170-4" title="4"><span class="st">         1,2,3&quot;</span>,</a>
<a class="sourceLine" id="cb170-5" title="5">         <span class="dt">delim =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">skip =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb170-6" title="6"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb170-7" title="7"><span class="co">#&gt;   `         x`     y     z</span></a>
<a class="sourceLine" id="cb170-8" title="8"><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb170-9" title="9"><span class="co">#&gt; 1 &quot;         1&quot;     2     3</span></a>
<a class="sourceLine" id="cb170-10" title="10"></a>
<a class="sourceLine" id="cb170-11" title="11"><span class="kw">read_delim</span>(<span class="st">&quot;# A comment I want to skip</span></a>
<a class="sourceLine" id="cb170-12" title="12"><span class="st">           x,y,z</span></a>
<a class="sourceLine" id="cb170-13" title="13"><span class="st">           1,2,3&quot;</span>,</a>
<a class="sourceLine" id="cb170-14" title="14">           <span class="dt">delim =</span> <span class="st">&quot;,&quot;</span>, <span class="dt">comment =</span> <span class="st">&quot;#&quot;</span>)</a>
<a class="sourceLine" id="cb170-15" title="15"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb170-16" title="16"><span class="co">#&gt;   `           x`     y     z</span></a>
<a class="sourceLine" id="cb170-17" title="17"><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb170-18" title="18"><span class="co">#&gt; 1 &quot;           1&quot;     2     3</span></a></code></pre></div>
<p>设置<code>na</code>:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">read_delim</span>(<span class="st">&quot;a,b,c</span></a>
<a class="sourceLine" id="cb171-2" title="2"><span class="st">           1,2,.&quot;</span>,</a>
<a class="sourceLine" id="cb171-3" title="3">           <span class="dt">delim =</span> <span class="st">&quot;,&quot;</span>,</a>
<a class="sourceLine" id="cb171-4" title="4">           <span class="dt">na =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb171-5" title="5"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb171-6" title="6"><span class="co">#&gt;   a                  b c    </span></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;lgl&gt;</span></a>
<a class="sourceLine" id="cb171-8" title="8"><span class="co">#&gt; 1 &quot;           1&quot;     2 NA</span></a></code></pre></div>
<div id="写入文件" class="section level3">
<h3><span class="header-section-number">3.2.1</span> 写入文件</h3>
<p><code>readr</code>还提供了两个非常有用的函数，用于将数据写回到磁盘：<code>write_csv()</code> 和 <code>write_tsv()</code>，这两个函数输出的文件能够顺利读取的概率更高，因为：</p>
<ul>
<li>它们总使用 UTF-8 对字符串进行编码<br />
</li>
<li>它们都是用 ISO 8601 日期格式来保存日期和日期时间数据</li>
</ul>
<p>如果想要将 CSV 文件导为 Excel 文件，可以使用 <code>write_excel_csv()</code> 函数，该函数会在文件开头写入一个特殊字符（字节顺序标记），告诉 Excel 这个文件采用的是 UTF-8 编码。</p>
<p>这几个函数中最重要的参数是 <code>x</code> (要保存的数据框)和<code>path</code>(保存文件的位置)。还可以使用 <code>na</code> 参数设定如何写入缺失值。默认情况下，写入函数会创建一个新文件或清空原有的文件再导入数据(Python中<code>open()</code>函数的<code>"mode = w"</code>模式)，如果想要追加到现有的文件，可以设置 <code>append = T</code> (Python中的<code>mode = "a"</code>模式)：</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">library</span>(gapminder)</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="kw">write_csv</span>(<span class="dt">x =</span> gapminder, <span class="dt">path =</span> <span class="st">&quot;data</span><span class="ch">\\</span><span class="st">gapminder.csv&quot;</span>)</a></code></pre></div>
<p>打开对应的文件：<br />
<img src="images/4.png" /></p>
</div>
<div id="练习-5" class="section level3">
<h3><span class="header-section-number">3.2.2</span> 练习</h3>

<div class="exercise">
<p><span id="exr:unnamed-chunk-12" class="exercise"><strong>Exercise 3.1  </strong></span>如果一个文件中的域是由“|”分隔的，那么应该使用哪个函数读取这个文件？</p>
</div>

<p>应该使用<code>read_delim(path, delim = "|")</code></p>

<div class="exercise">
<span id="exr:unnamed-chunk-13" class="exercise"><strong>Exercise 3.2  </strong></span><code>read_fwf()</code>函数中最重要的参数是什么？
</div>

<p><code>read_fwf()</code>用于固定宽度文件(fixed width files)。在固定宽度文件中，每一列的的宽度是固定的（不足的用某种填充符号填充），如第一列总是10个字符长度，第二列 5 个字符长度，第三列8个字符长度，每列内采取统一的对齐方式。<code>readr</code>安装时附带了一个固定宽度文件的示例,我们用一个变量存储它的路径：</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">fwf_sample &lt;-<span class="st"> </span><span class="kw">readr_example</span>(<span class="st">&quot;fwf-sample.txt&quot;</span>)</a>
<a class="sourceLine" id="cb173-2" title="2">fwf_sample</a>
<a class="sourceLine" id="cb173-3" title="3"><span class="co">#&gt; [1] &quot;C:/Users/56570/Documents/R/win-library/3.6/readr/extdata/fwf-sample.txt&quot;</span></a></code></pre></div>
<p>txt 文件内的内容：
<img src="images/3.png" /></p>
<p>读取固定宽度文件时，最重要的是告诉 R 每列的位置，参数 <code>col_positions</code> 用于这项工作，有几种不同的表示方式：</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="co"># You can specify column positions in several ways:</span></a>
<a class="sourceLine" id="cb174-2" title="2"><span class="co"># 1. Guess based on position of empty columns</span></a>
<a class="sourceLine" id="cb174-3" title="3"><span class="kw">read_fwf</span>(fwf_sample, </a>
<a class="sourceLine" id="cb174-4" title="4">         <span class="dt">col_positions =</span> <span class="kw">fwf_empty</span>(fwf_sample, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;first&quot;</span>, <span class="st">&quot;last&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;ssn&quot;</span>)))</a>
<a class="sourceLine" id="cb174-5" title="5"><span class="co">#&gt; # A tibble: 3 x 4</span></a>
<a class="sourceLine" id="cb174-6" title="6"><span class="co">#&gt;   first last     state ssn         </span></a>
<a class="sourceLine" id="cb174-7" title="7"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb174-8" title="8"><span class="co">#&gt; 1 John  Smith    WA    418-Y11-4111</span></a>
<a class="sourceLine" id="cb174-9" title="9"><span class="co">#&gt; 2 Mary  Hartford CA    319-Z19-4341</span></a>
<a class="sourceLine" id="cb174-10" title="10"><span class="co">#&gt; 3 Evan  Nolan    IL    219-532-c301</span></a>
<a class="sourceLine" id="cb174-11" title="11"><span class="co"># 2. A vector of field widths</span></a>
<a class="sourceLine" id="cb174-12" title="12"><span class="kw">read_fwf</span>(fwf_sample, </a>
<a class="sourceLine" id="cb174-13" title="13">         <span class="dt">col_positions =</span> <span class="kw">fwf_widths</span>(<span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">12</span>), <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;ssn&quot;</span>)))</a>
<a class="sourceLine" id="cb174-14" title="14"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb174-15" title="15"><span class="co">#&gt;   name          state ssn         </span></a>
<a class="sourceLine" id="cb174-16" title="16"><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb174-17" title="17"><span class="co">#&gt; 1 John Smith    WA    418-Y11-4111</span></a>
<a class="sourceLine" id="cb174-18" title="18"><span class="co">#&gt; 2 Mary Hartford CA    319-Z19-4341</span></a>
<a class="sourceLine" id="cb174-19" title="19"><span class="co">#&gt; 3 Evan Nolan    IL    219-532-c301</span></a>
<a class="sourceLine" id="cb174-20" title="20"><span class="co"># 3. Paired vectors of start and end positions</span></a>
<a class="sourceLine" id="cb174-21" title="21"><span class="kw">read_fwf</span>(fwf_sample,  </a>
<a class="sourceLine" id="cb174-22" title="22">         <span class="dt">col_positions =</span> <span class="kw">fwf_positions</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">30</span>), <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">42</span>), <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;ssn&quot;</span>)))</a>
<a class="sourceLine" id="cb174-23" title="23"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb174-24" title="24"><span class="co">#&gt;   name          ssn         </span></a>
<a class="sourceLine" id="cb174-25" title="25"><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb174-26" title="26"><span class="co">#&gt; 1 John Smith    418-Y11-4111</span></a>
<a class="sourceLine" id="cb174-27" title="27"><span class="co">#&gt; 2 Mary Hartford 319-Z19-4341</span></a>
<a class="sourceLine" id="cb174-28" title="28"><span class="co">#&gt; 3 Evan Nolan    219-532-c301</span></a>
<a class="sourceLine" id="cb174-29" title="29"><span class="co"># 4. Named arguments with start and end positions</span></a>
<a class="sourceLine" id="cb174-30" title="30"><span class="kw">read_fwf</span>(fwf_sample, </a>
<a class="sourceLine" id="cb174-31" title="31">         <span class="dt">col_positions =</span> <span class="kw">fwf_cols</span>(<span class="dt">name =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">20</span>), <span class="dt">ssn =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">42</span>)))</a>
<a class="sourceLine" id="cb174-32" title="32"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb174-33" title="33"><span class="co">#&gt;   name          ssn         </span></a>
<a class="sourceLine" id="cb174-34" title="34"><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb174-35" title="35"><span class="co">#&gt; 1 John Smith    418-Y11-4111</span></a>
<a class="sourceLine" id="cb174-36" title="36"><span class="co">#&gt; 2 Mary Hartford 319-Z19-4341</span></a>
<a class="sourceLine" id="cb174-37" title="37"><span class="co">#&gt; 3 Evan Nolan    219-532-c301</span></a>
<a class="sourceLine" id="cb174-38" title="38"><span class="co"># 5. Named arguments with column widths</span></a>
<a class="sourceLine" id="cb174-39" title="39"><span class="kw">read_fwf</span>(fwf_sample, </a>
<a class="sourceLine" id="cb174-40" title="40">         <span class="dt">col_positions =</span> <span class="kw">fwf_cols</span>(<span class="dt">name =</span> <span class="dv">20</span>, <span class="dt">state =</span> <span class="dv">10</span>, <span class="dt">ssn =</span> <span class="dv">12</span>))</a>
<a class="sourceLine" id="cb174-41" title="41"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb174-42" title="42"><span class="co">#&gt;   name          state ssn         </span></a>
<a class="sourceLine" id="cb174-43" title="43"><span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;       </span></a>
<a class="sourceLine" id="cb174-44" title="44"><span class="co">#&gt; 1 John Smith    WA    418-Y11-4111</span></a>
<a class="sourceLine" id="cb174-45" title="45"><span class="co">#&gt; 2 Mary Hartford CA    319-Z19-4341</span></a>
<a class="sourceLine" id="cb174-46" title="46"><span class="co">#&gt; 3 Evan Nolan    IL    219-532-c301</span></a></code></pre></div>
</div>
</div>
<div id="解析向量parsing-a-vector" class="section level2">
<h2><span class="header-section-number">3.3</span> 解析向量(Parsing a vector)</h2>
<p>在详细介绍 <code>readr</code> 如何从磁盘读取文件之前，我们需要先讨论一下 <code>parse_*()</code>函数族。这些函数接受一个字符向量（因为文件中的数据全部是以字符串的形式进入 R 的），并返回一个特定向量，如逻辑、整数或日期向量：</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1"><span class="co">## 用str()函数返回类别</span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="kw">str</span>(<span class="kw">parse_logical</span>(<span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;False&quot;</span>, <span class="st">&quot;True&quot;</span>)))</a>
<a class="sourceLine" id="cb175-3" title="3"><span class="co">#&gt;  logi [1:3] TRUE FALSE TRUE</span></a>
<a class="sourceLine" id="cb175-4" title="4"><span class="kw">str</span>(<span class="kw">parse_integer</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;3&quot;</span>)))</a>
<a class="sourceLine" id="cb175-5" title="5"><span class="co">#&gt;  int [1:3] 1 2 3</span></a>
<a class="sourceLine" id="cb175-6" title="6"><span class="kw">str</span>(<span class="kw">parse_date</span>(<span class="kw">c</span>(<span class="st">&quot;2010-01-01&quot;</span>, <span class="st">&quot;2019-08-15&quot;</span>)))</a>
<a class="sourceLine" id="cb175-7" title="7"><span class="co">#&gt;  Date[1:2], format: &quot;2010-01-01&quot; &quot;2019-08-15&quot;</span></a></code></pre></div>
<p>这些函数各司其职，且都是 <code>readr</code> 的重要组成部分。一旦掌握了本节中这些单个解析函数的用法，我们就可以继续讨论如何综合使用它们来解析整个文件了。</p>
<p>和 <code>tidyverse</code> 中出现的函数族一样，<code>parse_*()</code> 函数族有着相同的参数结构。第一个参数是需要解析的字符向量，<code>na</code>参数设定了哪些字符串应该当做缺失值处理：</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="kw">parse_integer</span>(<span class="kw">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;.&quot;</span>,<span class="st">&quot;456&quot;</span>),<span class="dt">na =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb176-2" title="2"><span class="co">#&gt; [1]   1   2  NA 456</span></a></code></pre></div>
<p>如果解析失败，你会收到一条警告：</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1">x &lt;-<span class="st"> </span><span class="kw">parse_integer</span>(<span class="kw">c</span>(<span class="st">&quot;123&quot;</span>, <span class="st">&quot;345&quot;</span>, <span class="st">&quot;abc&quot;</span>, <span class="st">&quot;123.45&quot;</span>))</a></code></pre></div>
<p>解析失败的值在输出中以缺失值的形式存在:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">x</a>
<a class="sourceLine" id="cb178-2" title="2"><span class="co">#&gt; [1] 123 345  NA  NA</span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="co">#&gt; attr(,&quot;problems&quot;)</span></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb178-5" title="5"><span class="co">#&gt;     row   col expected               actual</span></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb178-7" title="7"><span class="co">#&gt; 1     3    NA an integer             abc   </span></a>
<a class="sourceLine" id="cb178-8" title="8"><span class="co">#&gt; 2     4    NA no trailing characters .45</span></a></code></pre></div>
<p>如果解析失败的值很多，那么就应该使用 <code>problems()</code> 函数来获取完整的失败信息集合。这个函数会返回一个 tibble，可以使用 <code>dplyr</code> 来处理它：</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1"><span class="kw">problems</span>(x)</a>
<a class="sourceLine" id="cb179-2" title="2"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb179-3" title="3"><span class="co">#&gt;     row   col expected               actual</span></a>
<a class="sourceLine" id="cb179-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                  &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb179-5" title="5"><span class="co">#&gt; 1     3    NA an integer             abc   </span></a>
<a class="sourceLine" id="cb179-6" title="6"><span class="co">#&gt; 2     4    NA no trailing characters .45</span></a></code></pre></div>
<p>在解析函数的使用方面，最重要的是知道有哪些解析函数，以及每种解析函数用来处理哪种类型的输入。具体来说，重要的解析函数有8中：</p>
<ul>
<li><code>parse_logical()</code>和<code>parse_integer()</code>函数分别解析逻辑值和整数，因为这两个解析函数基本不会出现问题，所以我们不再进行更多介绍<br />
</li>
<li><code>parse_double()</code>是严格的数值型解析函数，而<code>parse_number()</code>则是灵活的数值型解析函数，这两个函数背后很复杂，因为世界各地书写数值的方式不尽相同<br />
</li>
<li><code>parse_character()</code>函数似乎太过简单，甚至没必要存在，因为R读取的文件本身就是字符串形式。但一个棘手的问题使得这个函数非常重要：字符编码<br />
</li>
<li><code>parse_factor()</code>函数可以创建因子，R使用这种数据结构表示分类变量，该变量具有固定数目的已知值<br />
</li>
<li><code>parse_datetime()</code>、<code>parse_date()</code>和<code>parse_time()</code>函数可以解析不同类型的日期和时间，它们是最复杂的，因为有太多不同的日期书写形式</li>
</ul>
<div id="数值" class="section level3">
<h3><span class="header-section-number">3.3.1</span> 数值</h3>
<p>解析数值似乎是直截了当的，但以下 3 个问题增加了数値解析的复杂性：</p>
<ul>
<li>世界各地的人们书写数值的方式不尽相同。例如有些国家使用<code>.</code>当做小数点，而有些国家使用<code>,</code><br />
</li>
<li>数值周围可能会有其他字符，例如<code>$1000</code>、<code>15℃</code> 和<code>10%</code><br />
</li>
<li>数值经常包含某种形式的分组(grouping)，以便更易读，如<code>1 000 000</code>，而且世界各地用来分组的字符也不统一</li>
</ul>
<p>为了解决第一个问题，<code>readr</code>使用了地区的概念(locale)，使得可以按照不同地区设置解析选项。在解析数值时，最重要的选项就是用来表示小数点的字符，通过设置一个新的地区对象并设定<code>decimal_mark</code>参数，可以覆盖<code>.</code>的默认值：</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1"><span class="kw">parse_double</span>(<span class="st">&quot;1.23&quot;</span>)</a>
<a class="sourceLine" id="cb180-2" title="2"><span class="co">#&gt; [1] 1.23</span></a>
<a class="sourceLine" id="cb180-3" title="3"><span class="kw">parse_double</span>(<span class="st">&quot;1,23&quot;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">decimal_mark =</span> <span class="st">&quot;,&quot;</span>))</a>
<a class="sourceLine" id="cb180-4" title="4"><span class="co">#&gt; [1] 1.23</span></a></code></pre></div>
<p><code>locale()</code>函数可以通过<code>decimal_mark,grouping_mark,date_format,time_format,tz,encoding</code>等参数创建一个地区对象，设定该地区内的一些表示习惯，这里我们告诉R哪个符号被用来当做小数点。</p>
<p><code>readr</code>的默认地区是US-centric。获取默认地区的另一种方法是利用操作系统，但这可能让你的代码只能在你的电脑上运行，通过电子邮件共享给另一个国家的同事时，就可能失效。</p>
<p><code>parse_number()</code>解决了第二个问题：<strong>它可以忽略数值前后的非数值型字符</strong>。这个函数特别适合处理货币和百分比，你可以提取嵌在文本中的数值：</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">parse_number</span>(<span class="st">&quot;$100&quot;</span>)</a>
<a class="sourceLine" id="cb181-2" title="2"><span class="co">#&gt; [1] 100</span></a>
<a class="sourceLine" id="cb181-3" title="3"><span class="kw">parse_number</span>(<span class="st">&quot;20%&quot;</span>)</a>
<a class="sourceLine" id="cb181-4" title="4"><span class="co">#&gt; [1] 20</span></a>
<a class="sourceLine" id="cb181-5" title="5"><span class="kw">parse_number</span>(<span class="st">&quot;37℃&quot;</span>)</a>
<a class="sourceLine" id="cb181-6" title="6"><span class="co">#&gt; [1] 37</span></a>
<a class="sourceLine" id="cb181-7" title="7"><span class="kw">parse_number</span>(<span class="st">&quot;It cost $123.45&quot;</span>)</a>
<a class="sourceLine" id="cb181-8" title="8"><span class="co">#&gt; [1] 123</span></a></code></pre></div>
<p>组合使用 <code>parse_number()</code> 和 <code>locale()</code> 可以解决最后一个问题，因为 <code>parse_number()</code> 可以忽略“分组符号” ：</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb182-1" title="1"><span class="co">## 适用于美国，忽略分组符号</span></a>
<a class="sourceLine" id="cb182-2" title="2"><span class="kw">parse_number</span>(<span class="st">&quot;123,456,789&quot;</span>)</a>
<a class="sourceLine" id="cb182-3" title="3"><span class="co">#&gt; [1] 1.23e+08</span></a>
<a class="sourceLine" id="cb182-4" title="4"><span class="co">## 适用于多数欧洲国家，需要用locale设置分组符号，因为.被默认为小数点</span></a>
<a class="sourceLine" id="cb182-5" title="5"><span class="kw">parse_number</span>(<span class="st">&quot;123.456.789&quot;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">grouping_mark =</span> <span class="st">&quot;.&quot;</span>))</a>
<a class="sourceLine" id="cb182-6" title="6"><span class="co">#&gt; [1] 1.23e+08</span></a>
<a class="sourceLine" id="cb182-7" title="7"><span class="co">## 适用于瑞士</span></a>
<a class="sourceLine" id="cb182-8" title="8"><span class="kw">parse_number</span>(<span class="st">&quot;123&#39;456&#39;789&quot;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">grouping_mark =</span> <span class="st">&quot;&#39;&quot;</span>))</a>
<a class="sourceLine" id="cb182-9" title="9"><span class="co">#&gt; [1] 1.23e+08</span></a></code></pre></div>
</div>
<div id="字符串" class="section level3">
<h3><span class="header-section-number">3.3.2</span> 字符串</h3>
<p><code>parse_character()</code> 似乎真的很简单，只要返回输入值就可以了。问题是同一个字符串有多种表示编码方式。在继续探讨之前，需要厘清一些概念：</p>
<ol style="list-style-type: decimal">
<li>什么是字符？</li>
</ol>
<blockquote>
<p>字符是各种文字和符号的总称，包括各个国家文字、标点符号、图形符号、数字等，甚至还包括表情符号。</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>什么是字符集？</li>
</ol>
<blockquote>
<p>字符集是多个字符的集合，字符集种类较多，每个字符集包含的字符个数不同，常见字符集有：ASCII字符集、ISO 8859字符集、GB2312字符集、BIG5字符集、GB18030字符集、Unicode字符集等。ASCII可以非常好地表示英文字符，因为它就是美国信息交换标准代码(American Standard Code for Information Interchange)的缩写。Unicode是国际组织制定的可以容纳世界上所有文字和符号的字符编码方案。</p>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>什么是字符编码？</li>
</ol>
<blockquote>
<p>计算机要准确的处理各种字符集文字，需要进行字符编码，以便计算机能够识别和存储各种文字。 字符编码(encoding)和字符集不同。字符集只是字符的集合，不一定适合作网络传送、处理，有时须经编码(encode)后才能应用。如Unicode可依不同需要以UTF-8、UTF-16、UTF-32等方式编码。 字符编码就是以二进制的数字来对应字符集的字符。因此，对字符进行编码，是信息交流的技术基础。</p>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li>概括</li>
</ol>
<blockquote>
<p>使用哪些字符。也就是说哪些汉字，字母和符号会被收入标准中。所包含“字符”的集合就叫做“字符集”。
规定每个“字符”分别用一个字节还是多个字节存储，用哪些字节来存储，这个规定就叫做“编码”。 各个国家和地区在制定编码标准的时候，“字符的集合”和“编码”一般都是同时制定的。因此，平常我们所说的“字符集”，比如：GB2312, GBK, JIS等，除了有“字符的集合”这层含义外，同时也包含了“编码”的含义。
注意：Unicode字符集有多种编码方式，如UTF-8、UTF-16等；ASCII只有一种；大多数MBCS（包括GB2312，GBK）也只有一种。</p>
</blockquote>
<p>在R中，我们可以使用<code>charToRaw()</code>函数获得一个字符串的底层表示（underlying representation）：</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">char_raw &lt;-<span class="st"> </span><span class="kw">charToRaw</span>(<span class="st">&quot;Maxine&quot;</span>)</a>
<a class="sourceLine" id="cb183-2" title="2">char_raw</a>
<a class="sourceLine" id="cb183-3" title="3"><span class="co">#&gt; [1] 4d 61 78 69 6e 65</span></a></code></pre></div>
<p><code>charToRaw()</code>返回的尚不是编码结果（二进制），而是十六进制的表示。每个十六进制数表示字符串的一个字节：<code>4d</code>是M，<code>61</code>是a等。<code>charToRaw()</code>返回的对象在R中被称为<code>raw type</code>，想要得到真正的二进制编码，要对<code>raw type</code>再使用<code>rawToBits()</code>函数：</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb184-1" title="1"><span class="kw">rawToBits</span>(char_raw)</a>
<a class="sourceLine" id="cb184-2" title="2"><span class="co">#&gt;  [1] 01 00 01 01 00 00 01 00 01 00 00 00 00 01 01 00 00 00 00 01 01 01 01 00 01</span></a>
<a class="sourceLine" id="cb184-3" title="3"><span class="co">#&gt; [26] 00 00 01 00 01 01 00 00 01 01 01 00 01 01 00 01 00 01 00 00 01 01 00</span></a></code></pre></div>
<p><code>readr</code>默认使用UTF-8编码。其中的含义在于，每当接受到一个字符串，R收到的不是字符串本身，而是它背后的二进制表示，于是R便尝试按照UTF-8的规则解读这些二进制码，把它们还原为人类所能理解的字符。问题是，如果你的文件不是用UTF-8编码，这就像用英文字典来解释汉语拼音，可能小张计算机存储字母”A”是1100001，而小王存储字母”A”是11000010，这样双方交换信息时就会误解。比如小张把1100001发送给小王，小王并不认为1100001是字母”A”，可能认为这是字母”X”，于是小王在用记事本访问存储在硬盘上的1100001时，在屏幕上显示的就是字母”X”。</p>
<p>要解决这个问题，需要在<code>parse_character()</code>函数中通过<code>locale(encoding = )</code>参数设定编码方式：</p>
<p>如何才能找到正确的编码方式呢？有可能数据来源会注明，但如果没有到话，<code>readr</code>包提供了<code>guess_encoding()</code>函数来帮助你找出编码方式。这个函数并非万无一失，如果有大量文本效果就会更好，它的第一个参数可以是直接的文件路径，也可以是一个<code>raw type</code>:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1"></a>
<a class="sourceLine" id="cb185-2" title="2"><span class="kw">guess_encoding</span>(<span class="kw">charToRaw</span>(<span class="st">&quot;中国&quot;</span>))</a>
<a class="sourceLine" id="cb185-3" title="3"><span class="co">#&gt; # A tibble: 1 x 2</span></a>
<a class="sourceLine" id="cb185-4" title="4"><span class="co">#&gt;   encoding confidence</span></a>
<a class="sourceLine" id="cb185-5" title="5"><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb185-6" title="6"><span class="co">#&gt; 1 ASCII             1</span></a>
<a class="sourceLine" id="cb185-7" title="7"><span class="kw">parse_character</span>(<span class="st">&quot;中国&quot;</span>,<span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>))</a>
<a class="sourceLine" id="cb185-8" title="8"><span class="co">#&gt; [1] &quot;&lt;U+4E2D&gt;&lt;U+56FD&gt;&quot;</span></a>
<a class="sourceLine" id="cb185-9" title="9"><span class="kw">parse_character</span>(<span class="st">&quot;中国&quot;</span>,<span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;windows-1252&quot;</span>))</a>
<a class="sourceLine" id="cb185-10" title="10"><span class="co">#&gt; [1] &quot;&lt;U+4E2D&gt;&lt;U+56FD&gt;&quot;</span></a>
<a class="sourceLine" id="cb185-11" title="11"></a>
<a class="sourceLine" id="cb185-12" title="12"><span class="kw">guess_encoding</span>(<span class="st">&quot;data</span><span class="ch">\\</span><span class="st">hotdogs.txt&quot;</span>)</a>
<a class="sourceLine" id="cb185-13" title="13"><span class="co">#&gt; # A tibble: 1 x 2</span></a>
<a class="sourceLine" id="cb185-14" title="14"><span class="co">#&gt;   encoding confidence</span></a>
<a class="sourceLine" id="cb185-15" title="15"><span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb185-16" title="16"><span class="co">#&gt; 1 ASCII             1</span></a></code></pre></div>
<p>编码问题博大精深，这里只是蜻蜓点水式地介绍一下。如果想要学习更多相关知识，可以阅读<a href="http://kunststube.net/encoding/">http://kunststube.net/encoding/</a></p>
</div>
<div id="因子" class="section level3">
<h3><span class="header-section-number">3.3.3</span> 因子</h3>
<p>因子对应的解析函数是 <code>parse_factor()</code> ，其中 <code>levels</code> 参数被赋予一个包含所有因子可能水平的向量，如果要解析的列存在 <code>levels</code> 中没有的值，就会生成一条警告。</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb186-1" title="1">fruit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>)</a>
<a class="sourceLine" id="cb186-2" title="2">f &lt;-<span class="st"> </span><span class="kw">parse_factor</span>(<span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;bananana&quot;</span>), <span class="dt">levels =</span> fruit)</a>
<a class="sourceLine" id="cb186-3" title="3"><span class="kw">problems</span>(f)</a>
<a class="sourceLine" id="cb186-4" title="4"><span class="co">#&gt; # A tibble: 1 x 4</span></a>
<a class="sourceLine" id="cb186-5" title="5"><span class="co">#&gt;     row   col expected           actual  </span></a>
<a class="sourceLine" id="cb186-6" title="6"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;   </span></a>
<a class="sourceLine" id="cb186-7" title="7"><span class="co">#&gt; 1     3    NA value in level set bananana</span></a></code></pre></div>
<p>如果有很多问题条目的话，最简单的是它们当做字符串来解析，然后用<code>forcats</code>包进行后续处理。</p>
</div>
<div id="日期时间日期时间" class="section level3">
<h3><span class="header-section-number">3.3.4</span> 日期时间、日期、时间</h3>
<p>根据需要的是日期型数据（从1970-01-01开始的天数）、日期时间型数据（从1970-01-01开始的秒数）还是时间型数据（从午夜开始的描述），我们可以在3中解析函数之间进行选择。在没有使用任何附加参数时调用，具体情况如下：</p>
<ul>
<li><code>parse_datetime()</code>期待的是符合 ISO 8601 标准的日期时间。ISO 8601是一种国际标准，其中日期的各个部分按从大到小的顺序排列，即年、月、日、小时、分钟、秒：</li>
</ul>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1"><span class="kw">parse_datetime</span>(<span class="st">&quot;2010-10-01 201002&quot;</span>)</a>
<a class="sourceLine" id="cb187-2" title="2"><span class="co">#&gt; [1] &quot;2010-10-01 20:10:02 UTC&quot;</span></a>
<a class="sourceLine" id="cb187-3" title="3"></a>
<a class="sourceLine" id="cb187-4" title="4"><span class="co">## 如果时间被忽略了，就会被设置为午夜</span></a>
<a class="sourceLine" id="cb187-5" title="5"><span class="kw">parse_datetime</span>(<span class="st">&quot;20101001&quot;</span>)</a>
<a class="sourceLine" id="cb187-6" title="6"><span class="co">#&gt; [1] &quot;2010-10-01 UTC&quot;</span></a></code></pre></div>
<p>这是最重要的日期/时间标准，如果经常使用日期和时间，可以阅读以下维基百科上的<a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601标准</a></p>
<ul>
<li><code>parse_date()</code>期待的是四位数的年份、一个<code>-</code>或者<code>/</code>作为分隔符，月，一个<code>-</code>或者<code>/</code>作为分隔符，然后是日：</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb188-1" title="1"><span class="kw">parse_date</span>(<span class="st">&quot;2010-10-01&quot;</span>)</a>
<a class="sourceLine" id="cb188-2" title="2"><span class="co">#&gt; [1] &quot;2010-10-01&quot;</span></a>
<a class="sourceLine" id="cb188-3" title="3"><span class="kw">parse_date</span>(<span class="st">&quot;2010/10/01&quot;</span>)</a>
<a class="sourceLine" id="cb188-4" title="4"><span class="co">#&gt; [1] &quot;2010-10-01&quot;</span></a></code></pre></div>
<ul>
<li><code>parse_time()</code>期待的是小时，<code>:</code>作为分隔符，分钟，可选的<code>:</code>和后面的秒，以及一个可选的 am/pm 标识符：</li>
</ul>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1"><span class="kw">parse_time</span>(<span class="st">&quot;8:20 pm&quot;</span>)</a>
<a class="sourceLine" id="cb189-2" title="2"><span class="co">#&gt; 20:20:00</span></a>
<a class="sourceLine" id="cb189-3" title="3"><span class="kw">parse_time</span>(<span class="st">&quot;8:20:05&quot;</span>)</a>
<a class="sourceLine" id="cb189-4" title="4"><span class="co">#&gt; 08:20:05</span></a></code></pre></div>
<p>如果默认数据不适合实际数据，那么可以为 <code>parse_date()</code> 的第二个参数 <code>format</code> 传入一个字符串指定自己的日期时间格式(这个参数是解析日期时间的函数在<code>parse_*()</code>函数族中特有的)，格式由以下各部分组成：</p>
<table>
<colgroup>
<col width="57%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th>成分</th>
<th>符号</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>年</td>
<td><code>%Y</code>(四位数)<br><code>%y</code>(两位数；00-69被解释为2000-2069、70-99被解释为1970-1999)</td>
</tr>
<tr class="even">
<td>月</td>
<td><code>%m</code>(两位数)<br> <code>%b</code>（简写名称，如“Jan”）<br> <code>%B</code>（完整名称，如January）</td>
</tr>
<tr class="odd">
<td>日</td>
<td><code>%d</code>(一位数或两位数) <br> %e(两位数)</td>
</tr>
<tr class="even">
<td>时间</td>
<td><code>%H</code>(0-23小时)<br><code>%I</code>(0-12小时，必须和<code>%p</code>一起使用) <br> <code>%p</code>(表示am/pm) <br> <code>%M</code>(分钟) <br> <code>S</code>(整数秒) <br> <code>%OS</code>(实数秒) <br> <code>%Z</code>(时区)</td>
</tr>
<tr class="odd">
<td>非数值字符</td>
<td><code>%.</code>(跳过一个非数值字符) <br> <code>%*</code>跳过所有非数值字符</td>
</tr>
</tbody>
</table>
<p>找出正确格式的最好方法是创建几个解析字符向量的示例，并使用某种解析函数进行测试（如果数据中有分隔符，则）：</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" title="1"><span class="kw">parse_date</span>(<span class="st">&quot;100101&quot;</span>,<span class="dt">format =</span> <span class="st">&quot;%m%d%y&quot;</span>)</a>
<a class="sourceLine" id="cb190-2" title="2"><span class="co">#&gt; [1] &quot;2001-10-01&quot;</span></a>
<a class="sourceLine" id="cb190-3" title="3"><span class="kw">parse_date</span>(<span class="st">&quot;01/02/15&quot;</span>,<span class="st">&quot;%y/%m/%d&quot;</span>)</a>
<a class="sourceLine" id="cb190-4" title="4"><span class="co">#&gt; [1] &quot;2001-02-15&quot;</span></a>
<a class="sourceLine" id="cb190-5" title="5"><span class="kw">parse_date</span>(<span class="st">&quot;Nov/12/1998&quot;</span>,<span class="st">&quot;%b/%d/%Y&quot;</span>)</a>
<a class="sourceLine" id="cb190-6" title="6"><span class="co">#&gt; [1] &quot;1998-11-12&quot;</span></a></code></pre></div>
</div>
<div id="练习-6" class="section level3">
<h3><span class="header-section-number">3.3.5</span> 练习</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-32" class="exercise"><strong>Exercise 3.3  </strong></span>如果在<code>locale()</code>函数中把<code>decimal_mark</code>和<code>grouping_mark</code>设为同一个字符，会发生什么情况？如果将<code>decimal_mark</code>设为逗号，<code>grouping_mark</code>的默认值会发生什么变化？如果将<code>grouping_mark</code>设置为句点，<code>decimal_mark</code>的默认值会发生什么变化？
</div>

<p>不能将<code>decimal_mark</code> 和 <code>group_mark</code>设为同一个字符：</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1"><span class="kw">locale</span>(<span class="dt">decimal_mark =</span> <span class="st">&quot;.&quot;</span>,<span class="dt">grouping_mark =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb191-2" title="2"><span class="co">#&gt; Error: `decimal_mark` and `grouping_mark` must be different</span></a></code></pre></div>
<p>将<code>decimal_mark</code>设为逗号时，<code>grouping_mark</code>的默认值将变为<code>.</code>(见第一行):</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" title="1"><span class="kw">locale</span>(<span class="dt">decimal_mark =</span> <span class="st">&quot;,&quot;</span>)</a>
<a class="sourceLine" id="cb192-2" title="2"><span class="co">#&gt; &lt;locale&gt;</span></a>
<a class="sourceLine" id="cb192-3" title="3"><span class="co">#&gt; Numbers:  123.456,78</span></a>
<a class="sourceLine" id="cb192-4" title="4"><span class="co">#&gt; Formats:  %AD / %AT</span></a>
<a class="sourceLine" id="cb192-5" title="5"><span class="co">#&gt; Timezone: UTC</span></a>
<a class="sourceLine" id="cb192-6" title="6"><span class="co">#&gt; Encoding: UTF-8</span></a>
<a class="sourceLine" id="cb192-7" title="7"><span class="co">#&gt; &lt;date_names&gt;</span></a>
<a class="sourceLine" id="cb192-8" title="8"><span class="co">#&gt; Days:   Sunday (Sun), Monday (Mon), Tuesday (Tue), Wednesday (Wed), Thursday</span></a>
<a class="sourceLine" id="cb192-9" title="9"><span class="co">#&gt;         (Thu), Friday (Fri), Saturday (Sat)</span></a>
<a class="sourceLine" id="cb192-10" title="10"><span class="co">#&gt; Months: January (Jan), February (Feb), March (Mar), April (Apr), May (May),</span></a>
<a class="sourceLine" id="cb192-11" title="11"><span class="co">#&gt;         June (Jun), July (Jul), August (Aug), September (Sep), October</span></a>
<a class="sourceLine" id="cb192-12" title="12"><span class="co">#&gt;         (Oct), November (Nov), December (Dec)</span></a>
<a class="sourceLine" id="cb192-13" title="13"><span class="co">#&gt; AM/PM:  AM/PM</span></a></code></pre></div>
<p>将<code>grouping_mark</code>设为句点时，<code>decimal_mark</code>的默认值将变为<code>,</code>:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1"><span class="kw">locale</span>(<span class="dt">grouping_mark =</span> <span class="st">&quot;.&quot;</span>)</a>
<a class="sourceLine" id="cb193-2" title="2"><span class="co">#&gt; &lt;locale&gt;</span></a>
<a class="sourceLine" id="cb193-3" title="3"><span class="co">#&gt; Numbers:  123.456,78</span></a>
<a class="sourceLine" id="cb193-4" title="4"><span class="co">#&gt; Formats:  %AD / %AT</span></a>
<a class="sourceLine" id="cb193-5" title="5"><span class="co">#&gt; Timezone: UTC</span></a>
<a class="sourceLine" id="cb193-6" title="6"><span class="co">#&gt; Encoding: UTF-8</span></a>
<a class="sourceLine" id="cb193-7" title="7"><span class="co">#&gt; &lt;date_names&gt;</span></a>
<a class="sourceLine" id="cb193-8" title="8"><span class="co">#&gt; Days:   Sunday (Sun), Monday (Mon), Tuesday (Tue), Wednesday (Wed), Thursday</span></a>
<a class="sourceLine" id="cb193-9" title="9"><span class="co">#&gt;         (Thu), Friday (Fri), Saturday (Sat)</span></a>
<a class="sourceLine" id="cb193-10" title="10"><span class="co">#&gt; Months: January (Jan), February (Feb), March (Mar), April (Apr), May (May),</span></a>
<a class="sourceLine" id="cb193-11" title="11"><span class="co">#&gt;         June (Jun), July (Jul), August (Aug), September (Sep), October</span></a>
<a class="sourceLine" id="cb193-12" title="12"><span class="co">#&gt;         (Oct), November (Nov), December (Dec)</span></a>
<a class="sourceLine" id="cb193-13" title="13"><span class="co">#&gt; AM/PM:  AM/PM</span></a></code></pre></div>

<div class="exercise">
<span id="exr:unnamed-chunk-36" class="exercise"><strong>Exercise 3.4  </strong></span><code>locale()</code>函数中的<code>date_format()</code>和<code>time_format()</code>参数有什么用？
</div>

<p><code>date_format()</code> 和 <code>time_format()</code> 和 <code>format</code> 参数的功能一样，用以指定日期时间数据的格式，如果在 <code>locale()</code> 中设定了以上两个参数，就不需要再设定 <code>format</code>；反之亦然：</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" title="1"><span class="kw">parse_date</span>(<span class="st">&quot;170625&quot;</span>, <span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">date_format =</span> <span class="st">&quot;%y%m%d&quot;</span>))</a>
<a class="sourceLine" id="cb194-2" title="2"><span class="co">#&gt; [1] &quot;2017-06-25&quot;</span></a></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>生成正确行使的字符串来解析以下日期和时间。</li>
</ol>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">d1 &lt;-<span class="st"> &quot;January 1,2010&quot;</span></a>
<a class="sourceLine" id="cb195-2" title="2"><span class="kw">parse_date</span>(d1,<span class="st">&quot;%B %d,%Y&quot;</span>)</a>
<a class="sourceLine" id="cb195-3" title="3"><span class="co">#&gt; [1] &quot;2010-01-01&quot;</span></a>
<a class="sourceLine" id="cb195-4" title="4"></a>
<a class="sourceLine" id="cb195-5" title="5">d2 &lt;-<span class="st"> &quot;2015-Mar-07&quot;</span></a>
<a class="sourceLine" id="cb195-6" title="6"><span class="kw">parse_date</span>(d2,<span class="st">&quot;%Y-%b-%e&quot;</span>)</a>
<a class="sourceLine" id="cb195-7" title="7"><span class="co">#&gt; [1] &quot;2015-03-07&quot;</span></a>
<a class="sourceLine" id="cb195-8" title="8"></a>
<a class="sourceLine" id="cb195-9" title="9">d3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;August 19 (2015)&quot;</span>,<span class="st">&quot;July 1 (2015)&quot;</span>)</a>
<a class="sourceLine" id="cb195-10" title="10"><span class="kw">parse_date</span>(d3,<span class="st">&quot;%B %d (%Y)&quot;</span>)</a>
<a class="sourceLine" id="cb195-11" title="11"><span class="co">#&gt; [1] &quot;2015-08-19&quot; &quot;2015-07-01&quot;</span></a>
<a class="sourceLine" id="cb195-12" title="12"></a>
<a class="sourceLine" id="cb195-13" title="13">t1 &lt;-<span class="st"> &quot;1705&quot;</span></a>
<a class="sourceLine" id="cb195-14" title="14"><span class="kw">parse_time</span>(<span class="st">&quot;1705&quot;</span>,<span class="st">&quot;%H%M&quot;</span>)</a>
<a class="sourceLine" id="cb195-15" title="15"><span class="co">#&gt; 17:05:00</span></a>
<a class="sourceLine" id="cb195-16" title="16"></a>
<a class="sourceLine" id="cb195-17" title="17">t2 &lt;-<span class="st"> &quot;11:15:10.12 PM&quot;</span></a>
<a class="sourceLine" id="cb195-18" title="18"><span class="kw">parse_time</span>(t2,<span class="st">&quot;%I:%M:%OS %p&quot;</span>)</a>
<a class="sourceLine" id="cb195-19" title="19"><span class="co">#&gt; 23:15:10.12</span></a></code></pre></div>
</div>
</div>
<div id="解析文件" class="section level2">
<h2><span class="header-section-number">3.4</span> 解析文件</h2>
<p>现在我们已经学会了如何用 <code>parse_*()</code> 函数族解析单个向量，接下来就能回到本章的最初目标，研究<code>readr</code>是如何解析文件的。我们将关注以下两点：</p>
<ul>
<li><code>readr</code>如何自动猜出文件每列的数据类型<br />
</li>
<li>如何修改默认设置</li>
</ul>
<div id="解析策略strategies" class="section level3">
<h3><span class="header-section-number">3.4.1</span> 解析策略(strategies)</h3>
<p><code>readr</code> 通过一种启发式过程(heuristic)来确定每列的类型：先读取文件的前1000行，然后使用（相对保守的）某种启发式算法确定每列的类型。<code>readr</code> 中的导入函数会先用 <code>guess_parser()</code> 函数返回对于所需解析函数最可信的猜测，然后尝试用可能性最大的解析函数解析该列：</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb196-1" title="1"><span class="kw">guess_parser</span>(<span class="st">&quot;123.45&quot;</span>)</a>
<a class="sourceLine" id="cb196-2" title="2"><span class="co">#&gt; [1] &quot;double&quot;</span></a>
<a class="sourceLine" id="cb196-3" title="3"><span class="kw">guess_parser</span>(<span class="st">&quot;12,352,561&quot;</span>)</a>
<a class="sourceLine" id="cb196-4" title="4"><span class="co">#&gt; [1] &quot;number&quot;</span></a>
<a class="sourceLine" id="cb196-5" title="5"><span class="kw">guess_parser</span>(<span class="st">&quot;1998-11-12&quot;</span>)</a>
<a class="sourceLine" id="cb196-6" title="6"><span class="co">#&gt; [1] &quot;date&quot;</span></a>
<a class="sourceLine" id="cb196-7" title="7"><span class="kw">guess_parser</span>(<span class="kw">c</span>(<span class="st">&quot;True&quot;</span>, <span class="st">&quot;False&quot;</span>))</a>
<a class="sourceLine" id="cb196-8" title="8"><span class="co">#&gt; [1] &quot;logical&quot;</span></a></code></pre></div>
<p>这个过程会依次尝试以下每种数据类型，直到找到匹配的类型。</p>
<p><strong>逻辑值(logical)</strong>：<br />
只包括<code>F</code>、<code>T</code>、<code>FALSE</code>和<code>True</code><br />
<strong>整数(integer)</strong><br />
只包括数值型字符（以及<code>-</code>）<br />
<strong>双精度浮点数(double)</strong><br />
只包括有效的双精度浮点数<br />
<strong>数值(number)</strong><br />
只包括带有分组符号的有效双精度浮点数<br />
<strong>时间</strong><br />
与默认的<code>time_format</code>匹配的值<br />
<strong>日期</strong><br />
与默认的<code>date_format</code>匹配的值<br />
<strong>日期时间</strong><br />
符合ISO 8601标准的任何日期</p>
<p>如果以上数据不符合上述要求中的任意一个，那么这一列就是一个字符串向量，<code>readr</code>将使用<code>parse_character()</code>解析它。</p>
</div>
<div id="可能遇到的问题" class="section level3">
<h3><span class="header-section-number">3.4.2</span> 可能遇到的问题</h3>
<p>这些默认设置对更大的文件并不总是有效。以下是两个可能遇到的主要问题：</p>
<ul>
<li><code>readr</code>通过前 1000 行猜测数据类型，但是前 1000 行可能只是一种特殊情况，不足以代表整列。例如，一列双精度数值的前1000行有可能都是整数<br />
</li>
<li>列中可能包含大量缺失值。如果前 1000 行都是<code>NA</code>，那么<code>readr</code>会认为这是一个字符向量，但你其实想将这一类解析为更具体的值。</li>
</ul>
<p><code>readr</code>的安装包里包含了一份文件<code>challenge.csv</code>，用来说明解析过程中可能遇到的问题。这个csv文件包含两列x，y和2001行观测。x 列的前 1001 行均为整数，但之后的值均为双精度整数。y 列的前 1001 行均为<code>NA</code>，后面是日期型数据：</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1"><span class="co">## readr_example()找到包含在R包中的文件的路径</span></a>
<a class="sourceLine" id="cb197-2" title="2">challenge &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>))</a></code></pre></div>
<p>可以看到，<code>read_csv()</code>成功解析了 <code>x</code>，但对于 <code>y</code> 则无从下手，因为使用了错误的解析函数<code>col_logical()</code>。使用 <code>problems()</code> 函数明确列出这些失败记录，以便深入探究其中的问题：</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb198-1" title="1"><span class="kw">problems</span>(challenge)</a>
<a class="sourceLine" id="cb198-2" title="2"><span class="co">#&gt; # A tibble: 1,000 x 5</span></a>
<a class="sourceLine" id="cb198-3" title="3"><span class="co">#&gt;     row col   expected       actual   file                                      </span></a>
<a class="sourceLine" id="cb198-4" title="4"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;    &lt;chr&gt;                                     </span></a>
<a class="sourceLine" id="cb198-5" title="5"><span class="co">#&gt; 1  1001 y     1/0/T/F/TRUE/… 2015-01… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-6" title="6"><span class="co">#&gt; 2  1002 y     1/0/T/F/TRUE/… 2018-05… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-7" title="7"><span class="co">#&gt; 3  1003 y     1/0/T/F/TRUE/… 2015-09… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-8" title="8"><span class="co">#&gt; 4  1004 y     1/0/T/F/TRUE/… 2012-11… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-9" title="9"><span class="co">#&gt; 5  1005 y     1/0/T/F/TRUE/… 2020-01… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-10" title="10"><span class="co">#&gt; 6  1006 y     1/0/T/F/TRUE/… 2016-04… &#39;C:/Users/56570/Documents/R/win-library/3…</span></a>
<a class="sourceLine" id="cb198-11" title="11"><span class="co">#&gt; # … with 994 more rows</span></a></code></pre></div>
<p>可以使用<code>spec_csv()</code> 函数来直接查看 <code>readr</code> 在默认情况下用那种类型的解析函数解析数据：</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="kw">spec_csv</span>(<span class="kw">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>))</a>
<a class="sourceLine" id="cb199-2" title="2"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb199-3" title="3"><span class="co">#&gt;   x = col_double(),</span></a>
<a class="sourceLine" id="cb199-4" title="4"><span class="co">#&gt;   y = col_logical()</span></a>
<a class="sourceLine" id="cb199-5" title="5"><span class="co">#&gt; )</span></a></code></pre></div>
<p>为了解决这个问题，我们用<code>read_csv()</code>函数中的<code>col_types</code>指定每列的解析方法(column specification)，之前我们向<code>col_types</code>传入一个字符串说明各列的类别，但这里是要直接指明解析函数了。这样做的指定必须通过<code>cols()</code>函数来创建(具体格式和<code>spec_csv()</code>或者<code>read_csv</code>自动打印的说明是一样的)：</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb200-1" title="1">challenge &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>),</a>
<a class="sourceLine" id="cb200-2" title="2">                      <span class="dt">col_types =</span><span class="kw">cols</span>(</a>
<a class="sourceLine" id="cb200-3" title="3">                         <span class="dt">x =</span> <span class="kw">col_double</span>(),</a>
<a class="sourceLine" id="cb200-4" title="4">                         <span class="dt">y =</span> <span class="kw">col_date</span>()</a>
<a class="sourceLine" id="cb200-5" title="5">))</a>
<a class="sourceLine" id="cb200-6" title="6"></a>
<a class="sourceLine" id="cb200-7" title="7"><span class="kw">tail</span>(challenge)</a>
<a class="sourceLine" id="cb200-8" title="8"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb200-9" title="9"><span class="co">#&gt;       x y         </span></a>
<a class="sourceLine" id="cb200-10" title="10"><span class="co">#&gt;   &lt;dbl&gt; &lt;date&gt;    </span></a>
<a class="sourceLine" id="cb200-11" title="11"><span class="co">#&gt; 1 0.805 2019-11-21</span></a>
<a class="sourceLine" id="cb200-12" title="12"><span class="co">#&gt; 2 0.164 2018-03-29</span></a>
<a class="sourceLine" id="cb200-13" title="13"><span class="co">#&gt; 3 0.472 2014-08-04</span></a>
<a class="sourceLine" id="cb200-14" title="14"><span class="co">#&gt; 4 0.718 2015-08-16</span></a>
<a class="sourceLine" id="cb200-15" title="15"><span class="co">#&gt; 5 0.270 2020-02-04</span></a>
<a class="sourceLine" id="cb200-16" title="16"><span class="co">#&gt; 6 0.608 2019-01-06</span></a></code></pre></div>
<p>每个<code>parse_*()</code>函数都有一个对应的<code>col_*()</code>函数。如果数据已经保存在R的字符向量中，那么可以使用<code>parse_*()</code>，如果要告诉<code>readr</code>如何加载数据，则应该使用<code>col_*()</code>。</p>
<p><strong>The available specifications are: (with string abbreviations in brackets)</strong></p>
<ul>
<li><code>col_logical()</code> [l], containing only T, F, TRUE or FALSE.<br />
</li>
<li><code>col_integer()</code> [i], integers.<br />
</li>
<li><code>col_double()</code> [d], doubles.<br />
</li>
<li><code>col_character()</code> [c], everything else.<br />
</li>
<li><code>col_factor(levels, ordered)</code> [f], a fixed set of values.<br />
</li>
<li><code>col_date(format = "")</code> [D]: with the locale’s date_format.<br />
</li>
<li><code>col_time(format = "")</code> [t]: with the locale’s time_format.<br />
</li>
<li><code>col_datetime(format = "")</code> [T]: ISO8601 date times<br />
</li>
<li><code>col_number()</code> [n], numbers containing the grouping_mark<br />
</li>
<li><code>col_skip()</code> [_, -], don’t import this column.<br />
</li>
<li><code>col_guess()</code> [?], parse using the “best” type based on the input.</li>
</ul>
<p><code>cols_only()</code>代替<code>cols()</code>可以仅指定部分列的解析方式；<code>.default</code>表示未提及的所有列(<code>read_csv()</code>的默认设置可以表示为<code>read_csv( col_type = cols(.default = col_guess()))</code></p>
<p>一旦我们指定了正确的解析函数，问题便迎刃而解。</p>
</div>
<div id="其他技巧" class="section level3">
<h3><span class="header-section-number">3.4.3</span> 其他技巧</h3>
<p>我们再介绍其他几种有注意解析文件的通用技巧：</p>
<ul>
<li>在前面的示例中，如果比默认方式再多检查一行，我们就能一蹴而就，解析成功：</li>
</ul>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1">challenge &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="kw">readr_example</span>(<span class="st">&quot;challenge.csv&quot;</span>),</a>
<a class="sourceLine" id="cb201-2" title="2">                      <span class="dt">guess_max =</span> <span class="dv">1001</span>)</a></code></pre></div>
<ul>
<li><code>type_convert()</code>函数在一个数据框的所有字符列上应用启发式解析过程：</li>
</ul>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb202-1" title="1">df &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb202-2" title="2">  <span class="op">~</span>x,<span class="op">~</span>y,</a>
<a class="sourceLine" id="cb202-3" title="3">  <span class="st">&quot;1&quot;</span>,<span class="st">&quot;1.21&quot;</span>,</a>
<a class="sourceLine" id="cb202-4" title="4">  <span class="st">&quot;4&quot;</span>,<span class="st">&quot;2,32&quot;</span>,</a>
<a class="sourceLine" id="cb202-5" title="5">  <span class="st">&quot;3&quot;</span>,<span class="st">&quot;4,56&quot;</span></a>
<a class="sourceLine" id="cb202-6" title="6">)</a>
<a class="sourceLine" id="cb202-7" title="7">df</a>
<a class="sourceLine" id="cb202-8" title="8"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb202-9" title="9"><span class="co">#&gt;   x     y    </span></a>
<a class="sourceLine" id="cb202-10" title="10"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb202-11" title="11"><span class="co">#&gt; 1 1     1.21 </span></a>
<a class="sourceLine" id="cb202-12" title="12"><span class="co">#&gt; 2 4     2,32 </span></a>
<a class="sourceLine" id="cb202-13" title="13"><span class="co">#&gt; 3 3     4,56</span></a>
<a class="sourceLine" id="cb202-14" title="14"></a>
<a class="sourceLine" id="cb202-15" title="15"><span class="co">## 注意列类型</span></a>
<a class="sourceLine" id="cb202-16" title="16"><span class="kw">type_convert</span>(df)</a>
<a class="sourceLine" id="cb202-17" title="17"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb202-18" title="18"><span class="co">#&gt;       x      y</span></a>
<a class="sourceLine" id="cb202-19" title="19"><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb202-20" title="20"><span class="co">#&gt; 1     1   1.21</span></a>
<a class="sourceLine" id="cb202-21" title="21"><span class="co">#&gt; 2     4 232   </span></a>
<a class="sourceLine" id="cb202-22" title="22"><span class="co">#&gt; 3     3 456</span></a></code></pre></div>
<ul>
<li>如果正在读取一个非常大的文件，那么应该将<code>n_max</code>设置为一个较小的数，比如10,000或者100,000，这可以让我们在解决常见问题时加快重复试验的过程。</li>
</ul>
</div>
</div>
<div id="readxl" class="section level2">
<h2><span class="header-section-number">3.5</span> readxl</h2>
<p>要想将其他类型的数据导入 R 中，可以先从下列的<code>tidyverse</code>包开始。对矩形数据来说：</p>
<ul>
<li><p><code>haven</code>可以读取SPSS、Stata和SAS文件:<br />
<img src="images/5.png" /></p></li>
<li><p>配合专用的数据库后端程序（如 RMySQL，RSQLite，RpostgreSQL等），DBI可以对相应数据库进行SQL查询，并返回一个数据框<br />
</p></li>
<li><p><code>readxl</code> 专门为读取 Excel 文件打造(.xlsx和xls均可)</p></li>
</ul>
<p>下面主要介绍 <code>readxl</code> 的用法，不同于<code>readr</code>，<code>readxl</code> 不是 <code>tidyverse</code> 的核心包，我们总需要显示地加载它：</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1"><span class="kw">library</span>(readxl)</a></code></pre></div>
<p><code>read_excel()</code> 是 <code>readxl</code> 中的核心函数，它的第一个参数<code>path</code>接受 <code>xlsx</code> 或 <code>xls</code> 文件的路径。但由于一个 Excel 文件（工作簿）经常包含多个工作表，所以我们在读取时需要指明某张工作表，<code>excel_sheets()</code> 函数返回一个工作簿文件中各个工作表(sheet)的名字：</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb204-1" title="1"><span class="co">## readxl附带的Excel文件</span></a>
<a class="sourceLine" id="cb204-2" title="2"><span class="kw">readxl_example</span>()</a>
<a class="sourceLine" id="cb204-3" title="3"><span class="co">#&gt;  [1] &quot;clippy.xls&quot;    &quot;clippy.xlsx&quot;   &quot;datasets.xls&quot;  &quot;datasets.xlsx&quot;</span></a>
<a class="sourceLine" id="cb204-4" title="4"><span class="co">#&gt;  [5] &quot;deaths.xls&quot;    &quot;deaths.xlsx&quot;   &quot;geometry.xls&quot;  &quot;geometry.xlsx&quot;</span></a>
<a class="sourceLine" id="cb204-5" title="5"><span class="co">#&gt;  [9] &quot;type-me.xls&quot;   &quot;type-me.xlsx&quot;</span></a>
<a class="sourceLine" id="cb204-6" title="6"><span class="co">## read_expample()函数获取路径</span></a>
<a class="sourceLine" id="cb204-7" title="7">path &lt;-<span class="st"> </span><span class="kw">readxl_example</span>(<span class="st">&quot;deaths.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb204-8" title="8"><span class="kw">excel_sheets</span>(path)</a>
<a class="sourceLine" id="cb204-9" title="9"><span class="co">#&gt; [1] &quot;arts&quot;  &quot;other&quot;</span></a></code></pre></div>
<p>获悉一个工作簿内部的表结构以后，可以使用<code>sheets</code>参数指定要读取的表，可以是一个整数（第几张彪），也可以是字符串（表明）, <code>read_excel()</code>默认读取第一张表：</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">deaths &lt;-<span class="st"> </span><span class="kw">read_excel</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;arts&quot;</span>)</a></code></pre></div>
<p>经常会在读取Excel文件时遇到的一个问题是,有些人喜欢在表格的前面几行或最后几行添加一些无关真正分析内容元数据（metadata），比如在<code>deaths.xlsx</code>这个Excel文件中：<br />
<img src="images/9.png" /></p>
<p>默认设置下，<code>read_excel()</code>会将这些元数据一并读入：</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb206-1" title="1">deaths </a>
<a class="sourceLine" id="cb206-2" title="2"><span class="co">#&gt; # A tibble: 18 x 6</span></a>
<a class="sourceLine" id="cb206-3" title="3"><span class="co">#&gt;   `Lots of people`           ...2      ...3  ...4    ...5        ...6           </span></a>
<a class="sourceLine" id="cb206-4" title="4"><span class="co">#&gt;   &lt;chr&gt;                      &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;          </span></a>
<a class="sourceLine" id="cb206-5" title="5"><span class="co">#&gt; 1 simply cannot resist writ… &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;        some notes     </span></a>
<a class="sourceLine" id="cb206-6" title="6"><span class="co">#&gt; 2 at                         the       top   &lt;NA&gt;    of          their spreadsh…</span></a>
<a class="sourceLine" id="cb206-7" title="7"><span class="co">#&gt; 3 or                         merging   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;        cells          </span></a>
<a class="sourceLine" id="cb206-8" title="8"><span class="co">#&gt; 4 Name                       Professi… Age   Has ki… Date of bi… Date of death  </span></a>
<a class="sourceLine" id="cb206-9" title="9"><span class="co">#&gt; 5 David Bowie                musician  69    TRUE    17175       42379          </span></a>
<a class="sourceLine" id="cb206-10" title="10"><span class="co">#&gt; 6 Carrie Fisher              actor     60    TRUE    20749       42731          </span></a>
<a class="sourceLine" id="cb206-11" title="11"><span class="co">#&gt; # … with 12 more rows</span></a></code></pre></div>
<p>一个很有用的方法是通过Rstudio的File<span class="math inline">\(\rightarrow\)</span>Import Dataset<span class="math inline">\(\rightarrow\)</span>From Excel 接口导入数据，我们可以通过预览来观察导入后的数据，还可以对<code>read_excel()</code>的导入参数进行设置：</p>
<p><img src="images/7.png" /></p>
<p><img src="images/8.png" /></p>
<p>对于<code>deaths.xlsx</code>这个Excel文件，可以结合使用<code>n_max</code> 和 <code>skip</code> 参数去除不想读取的部分（分别对应图形界面里的Max Rows和Skip：</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1"><span class="kw">read_excel</span>(path,  <span class="dt">skip=</span> <span class="dv">4</span>, <span class="dt">n_max =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb207-2" title="2"><span class="co">#&gt; # A tibble: 10 x 6</span></a>
<a class="sourceLine" id="cb207-3" title="3"><span class="co">#&gt;   Name       Profession   Age `Has kids` `Date of birth`     `Date of death`    </span></a>
<a class="sourceLine" id="cb207-4" title="4"><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;              &lt;dttm&gt;             </span></a>
<a class="sourceLine" id="cb207-5" title="5"><span class="co">#&gt; 1 David Bow… musician      69 TRUE       1947-01-08 00:00:00 2016-01-10 00:00:00</span></a>
<a class="sourceLine" id="cb207-6" title="6"><span class="co">#&gt; 2 Carrie Fi… actor         60 TRUE       1956-10-21 00:00:00 2016-12-27 00:00:00</span></a>
<a class="sourceLine" id="cb207-7" title="7"><span class="co">#&gt; 3 Chuck Ber… musician      90 TRUE       1926-10-18 00:00:00 2017-03-18 00:00:00</span></a>
<a class="sourceLine" id="cb207-8" title="8"><span class="co">#&gt; 4 Bill Paxt… actor         61 TRUE       1955-05-17 00:00:00 2017-02-25 00:00:00</span></a>
<a class="sourceLine" id="cb207-9" title="9"><span class="co">#&gt; 5 Prince     musician      57 TRUE       1958-06-07 00:00:00 2016-04-21 00:00:00</span></a>
<a class="sourceLine" id="cb207-10" title="10"><span class="co">#&gt; 6 Alan Rick… actor         69 FALSE      1946-02-21 00:00:00 2016-01-14 00:00:00</span></a>
<a class="sourceLine" id="cb207-11" title="11"><span class="co">#&gt; # … with 4 more rows</span></a></code></pre></div>
<p><code>read_excel()</code>中另一个很有用的参数是<code>range</code>，用于指定一块Excel表中要读取的区域：</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb208-1" title="1"><span class="kw">read_excel</span>(path, <span class="dt">sheet =</span> <span class="st">&quot;arts&quot;</span>, <span class="dt">range =</span> <span class="st">&quot;A5:F15&quot;</span>)</a>
<a class="sourceLine" id="cb208-2" title="2"><span class="co">#&gt; # A tibble: 10 x 6</span></a>
<a class="sourceLine" id="cb208-3" title="3"><span class="co">#&gt;   Name       Profession   Age `Has kids` `Date of birth`     `Date of death`    </span></a>
<a class="sourceLine" id="cb208-4" title="4"><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;              &lt;dttm&gt;             </span></a>
<a class="sourceLine" id="cb208-5" title="5"><span class="co">#&gt; 1 David Bow… musician      69 TRUE       1947-01-08 00:00:00 2016-01-10 00:00:00</span></a>
<a class="sourceLine" id="cb208-6" title="6"><span class="co">#&gt; 2 Carrie Fi… actor         60 TRUE       1956-10-21 00:00:00 2016-12-27 00:00:00</span></a>
<a class="sourceLine" id="cb208-7" title="7"><span class="co">#&gt; 3 Chuck Ber… musician      90 TRUE       1926-10-18 00:00:00 2017-03-18 00:00:00</span></a>
<a class="sourceLine" id="cb208-8" title="8"><span class="co">#&gt; 4 Bill Paxt… actor         61 TRUE       1955-05-17 00:00:00 2017-02-25 00:00:00</span></a>
<a class="sourceLine" id="cb208-9" title="9"><span class="co">#&gt; 5 Prince     musician      57 TRUE       1958-06-07 00:00:00 2016-04-21 00:00:00</span></a>
<a class="sourceLine" id="cb208-10" title="10"><span class="co">#&gt; 6 Alan Rick… actor         69 FALSE      1946-02-21 00:00:00 2016-01-14 00:00:00</span></a>
<a class="sourceLine" id="cb208-11" title="11"><span class="co">#&gt; # … with 4 more rows</span></a>
<a class="sourceLine" id="cb208-12" title="12"><span class="co">## 还可以在range中指定列名</span></a>
<a class="sourceLine" id="cb208-13" title="13"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="st">&quot;arts!A5:F15&quot;</span>)</a>
<a class="sourceLine" id="cb208-14" title="14"><span class="co">#&gt; # A tibble: 10 x 6</span></a>
<a class="sourceLine" id="cb208-15" title="15"><span class="co">#&gt;   Name       Profession   Age `Has kids` `Date of birth`     `Date of death`    </span></a>
<a class="sourceLine" id="cb208-16" title="16"><span class="co">#&gt;   &lt;chr&gt;      &lt;chr&gt;      &lt;dbl&gt; &lt;lgl&gt;      &lt;dttm&gt;              &lt;dttm&gt;             </span></a>
<a class="sourceLine" id="cb208-17" title="17"><span class="co">#&gt; 1 David Bow… musician      69 TRUE       1947-01-08 00:00:00 2016-01-10 00:00:00</span></a>
<a class="sourceLine" id="cb208-18" title="18"><span class="co">#&gt; 2 Carrie Fi… actor         60 TRUE       1956-10-21 00:00:00 2016-12-27 00:00:00</span></a>
<a class="sourceLine" id="cb208-19" title="19"><span class="co">#&gt; 3 Chuck Ber… musician      90 TRUE       1926-10-18 00:00:00 2017-03-18 00:00:00</span></a>
<a class="sourceLine" id="cb208-20" title="20"><span class="co">#&gt; 4 Bill Paxt… actor         61 TRUE       1955-05-17 00:00:00 2017-02-25 00:00:00</span></a>
<a class="sourceLine" id="cb208-21" title="21"><span class="co">#&gt; 5 Prince     musician      57 TRUE       1958-06-07 00:00:00 2016-04-21 00:00:00</span></a>
<a class="sourceLine" id="cb208-22" title="22"><span class="co">#&gt; 6 Alan Rick… actor         69 FALSE      1946-02-21 00:00:00 2016-01-14 00:00:00</span></a>
<a class="sourceLine" id="cb208-23" title="23"><span class="co">#&gt; # … with 4 more rows</span></a></code></pre></div>
<p>与<code>range</code>相关的帮助函数<code>cell_rows()</code>、<code>cell_cols()</code>和<code>cell_limits()</code>可以为区域选择提供更大的自由度，下面的示例中使用文件<code>geometry.xls</code>，读取预览：<br />
<img src="images/10.png" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1">path &lt;-<span class="st"> </span><span class="kw">readxl_example</span>(<span class="st">&quot;geometry.xls&quot;</span>)</a>
<a class="sourceLine" id="cb209-2" title="2"><span class="co"># Specify only the rows or only the columns</span></a>
<a class="sourceLine" id="cb209-3" title="3"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>))</a>
<a class="sourceLine" id="cb209-4" title="4"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb209-5" title="5"><span class="co">#&gt;   B3    C3    D3   </span></a>
<a class="sourceLine" id="cb209-6" title="6"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-7" title="7"><span class="co">#&gt; 1 B4    C4    D4   </span></a>
<a class="sourceLine" id="cb209-8" title="8"><span class="co">#&gt; 2 B5    C5    D5   </span></a>
<a class="sourceLine" id="cb209-9" title="9"><span class="co">#&gt; 3 B6    C6    D6</span></a>
<a class="sourceLine" id="cb209-10" title="10"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="st">&quot;C:D&quot;</span>))</a>
<a class="sourceLine" id="cb209-11" title="11"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb209-12" title="12"><span class="co">#&gt;   C3    D3   </span></a>
<a class="sourceLine" id="cb209-13" title="13"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-14" title="14"><span class="co">#&gt; 1 C4    D4   </span></a>
<a class="sourceLine" id="cb209-15" title="15"><span class="co">#&gt; 2 C5    D5   </span></a>
<a class="sourceLine" id="cb209-16" title="16"><span class="co">#&gt; 3 C6    D6</span></a>
<a class="sourceLine" id="cb209-17" title="17"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb209-18" title="18"><span class="co">#&gt; # A tibble: 3 x 1</span></a>
<a class="sourceLine" id="cb209-19" title="19"><span class="co">#&gt;   B3   </span></a>
<a class="sourceLine" id="cb209-20" title="20"><span class="co">#&gt;   &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-21" title="21"><span class="co">#&gt; 1 B4   </span></a>
<a class="sourceLine" id="cb209-22" title="22"><span class="co">#&gt; 2 B5   </span></a>
<a class="sourceLine" id="cb209-23" title="23"><span class="co">#&gt; 3 B6</span></a>
<a class="sourceLine" id="cb209-24" title="24"></a>
<a class="sourceLine" id="cb209-25" title="25"><span class="co"># Specify exactly one row or column bound</span></a>
<a class="sourceLine" id="cb209-26" title="26"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="kw">c</span>(<span class="dv">5</span>, <span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb209-27" title="27"><span class="co">#&gt; # A tibble: 1 x 3</span></a>
<a class="sourceLine" id="cb209-28" title="28"><span class="co">#&gt;   B5    C5    D5   </span></a>
<a class="sourceLine" id="cb209-29" title="29"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-30" title="30"><span class="co">#&gt; 1 B6    C6    D6</span></a>
<a class="sourceLine" id="cb209-31" title="31"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_rows</span>(<span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb209-32" title="32"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb209-33" title="33"><span class="co">#&gt;   ...1  ...2  ...3 </span></a>
<a class="sourceLine" id="cb209-34" title="34"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-35" title="35"><span class="co">#&gt; 1 &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb209-36" title="36"><span class="co">#&gt; 2 B3    C3    D3   </span></a>
<a class="sourceLine" id="cb209-37" title="37"><span class="co">#&gt; 3 B4    C4    D4</span></a>
<a class="sourceLine" id="cb209-38" title="38"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb209-39" title="39"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb209-40" title="40"><span class="co">#&gt;   C3    D3   </span></a>
<a class="sourceLine" id="cb209-41" title="41"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-42" title="42"><span class="co">#&gt; 1 C4    D4   </span></a>
<a class="sourceLine" id="cb209-43" title="43"><span class="co">#&gt; 2 C5    D5   </span></a>
<a class="sourceLine" id="cb209-44" title="44"><span class="co">#&gt; 3 C6    D6</span></a>
<a class="sourceLine" id="cb209-45" title="45"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_cols</span>(<span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb209-46" title="46"><span class="co">#&gt; # A tibble: 3 x 2</span></a>
<a class="sourceLine" id="cb209-47" title="47"><span class="co">#&gt;   ...1  B3   </span></a>
<a class="sourceLine" id="cb209-48" title="48"><span class="co">#&gt;   &lt;lgl&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-49" title="49"><span class="co">#&gt; 1 NA    B4   </span></a>
<a class="sourceLine" id="cb209-50" title="50"><span class="co">#&gt; 2 NA    B5   </span></a>
<a class="sourceLine" id="cb209-51" title="51"><span class="co">#&gt; 3 NA    B6</span></a>
<a class="sourceLine" id="cb209-52" title="52"></a>
<a class="sourceLine" id="cb209-53" title="53"><span class="co"># General open rectangles</span></a>
<a class="sourceLine" id="cb209-54" title="54"><span class="co"># upper left = C4, everything else unspecified</span></a>
<a class="sourceLine" id="cb209-55" title="55"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_limits</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>), <span class="kw">c</span>(<span class="ot">NA</span>, <span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb209-56" title="56"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb209-57" title="57"><span class="co">#&gt;   C4    D4   </span></a>
<a class="sourceLine" id="cb209-58" title="58"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-59" title="59"><span class="co">#&gt; 1 C5    D5   </span></a>
<a class="sourceLine" id="cb209-60" title="60"><span class="co">#&gt; 2 C6    D6</span></a>
<a class="sourceLine" id="cb209-61" title="61"><span class="co"># upper right = D4, everything else unspecified</span></a>
<a class="sourceLine" id="cb209-62" title="62"><span class="kw">read_excel</span>(path, <span class="dt">range =</span> <span class="kw">cell_limits</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="ot">NA</span>), <span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">4</span>)))</a>
<a class="sourceLine" id="cb209-63" title="63"><span class="co">#&gt; # A tibble: 2 x 4</span></a>
<a class="sourceLine" id="cb209-64" title="64"><span class="co">#&gt;   ...1  B4    C4    D4   </span></a>
<a class="sourceLine" id="cb209-65" title="65"><span class="co">#&gt;   &lt;lgl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb209-66" title="66"><span class="co">#&gt; 1 NA    B5    C5    D5   </span></a>
<a class="sourceLine" id="cb209-67" title="67"><span class="co">#&gt; 2 NA    B6    C6    D6</span></a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tibble.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lubridate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/rfordatascience/edit/master/readr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
