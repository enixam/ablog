<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.2 Example: the great library heist | Text Mining with R — Notes</title>
  <meta name="description" content="6.2 Example: the great library heist | Text Mining with R — Notes" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6.2 Example: the great library heist | Text Mining with R — Notes" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/tidy-text-mining" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Example: the great library heist | Text Mining with R — Notes" />
  
  
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-04-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="latent-dirichlet-allocation.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for Text Mining with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Text Mining with R</b></span></li>
<li class="chapter" data-level="1" data-path="tidy-text-format.html"><a href="tidy-text-format.html"><i class="fa fa-check"></i><b>1</b> Tidy text format</a><ul>
<li class="chapter" data-level="1.1" data-path="the-unnest-tokens-function.html"><a href="the-unnest-tokens-function.html"><i class="fa fa-check"></i><b>1.1</b> The <code>unnest_tokens()</code> function</a></li>
<li class="chapter" data-level="1.2" data-path="the-gutenbergr-package.html"><a href="the-gutenbergr-package.html"><i class="fa fa-check"></i><b>1.2</b> The <code>gutenbergr</code> package</a></li>
<li class="chapter" data-level="1.3" data-path="compare-word-frequency.html"><a href="compare-word-frequency.html"><i class="fa fa-check"></i><b>1.3</b> Compare word frequency</a></li>
<li class="chapter" data-level="1.4" data-path="other-tokenization-methods.html"><a href="other-tokenization-methods.html"><i class="fa fa-check"></i><b>1.4</b> Other tokenization methods</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sentiment-analysis-with-tidy-data.html"><a href="sentiment-analysis-with-tidy-data.html"><i class="fa fa-check"></i><b>2</b> Sentiment analysis with tidy data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-sentiments-dataset.html"><a href="the-sentiments-dataset.html"><i class="fa fa-check"></i><b>2.1</b> The <code>sentiments</code> dataset</a></li>
<li class="chapter" data-level="2.2" data-path="sentiment-analysis-with-inner-join.html"><a href="sentiment-analysis-with-inner-join.html"><i class="fa fa-check"></i><b>2.2</b> Sentiment analysis with inner join</a></li>
<li class="chapter" data-level="2.3" data-path="comparing-3-different-dictionaries.html"><a href="comparing-3-different-dictionaries.html"><i class="fa fa-check"></i><b>2.3</b> Comparing 3 different dictionaries</a></li>
<li class="chapter" data-level="2.4" data-path="most-common-positive-and-negative-words.html"><a href="most-common-positive-and-negative-words.html"><i class="fa fa-check"></i><b>2.4</b> Most common positive and negative words</a></li>
<li class="chapter" data-level="2.5" data-path="wordclouds.html"><a href="wordclouds.html"><i class="fa fa-check"></i><b>2.5</b> Wordclouds</a></li>
<li class="chapter" data-level="2.6" data-path="units-other-than-words.html"><a href="units-other-than-words.html"><i class="fa fa-check"></i><b>2.6</b> Units other than words</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyzing-word-and-document-frequency.html"><a href="analyzing-word-and-document-frequency.html"><i class="fa fa-check"></i><b>3</b> Analyzing word and document frequency</a><ul>
<li class="chapter" data-level="3.1" data-path="tf-idf.html"><a href="tf-idf.html"><i class="fa fa-check"></i><b>3.1</b> tf-idf</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tf-idf.html"><a href="tf-idf.html#term-frequency-in-jane-austens-novels"><i class="fa fa-check"></i><b>3.1.1</b> Term frequency in Jane Austen’s novels</a></li>
<li class="chapter" data-level="3.1.2" data-path="tf-idf.html"><a href="tf-idf.html#zipfs-law"><i class="fa fa-check"></i><b>3.1.2</b> Zipf’s law</a></li>
<li class="chapter" data-level="3.1.3" data-path="tf-idf.html"><a href="tf-idf.html#word-rank-slope-chart"><i class="fa fa-check"></i><b>3.1.3</b> Word rank slope chart</a></li>
<li class="chapter" data-level="3.1.4" data-path="tf-idf.html"><a href="tf-idf.html#the-bind_tf_idf-function"><i class="fa fa-check"></i><b>3.1.4</b> The <code>bind_tf_idf()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html"><i class="fa fa-check"></i><b>3.2</b> Weighted log odds ratio</a><ul>
<li class="chapter" data-level="3.2.1" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#log-odds-ratio"><i class="fa fa-check"></i><b>3.2.1</b> Log odds ratio</a></li>
<li class="chapter" data-level="3.2.2" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#model-based-approach-weighted-log-odds-ratio"><i class="fa fa-check"></i><b>3.2.2</b> Model-based approach: Weighted log odds ratio</a></li>
<li class="chapter" data-level="3.2.3" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#discussions"><i class="fa fa-check"></i><b>3.2.3</b> Discussions</a></li>
<li class="chapter" data-level="3.2.4" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#bind_log_odds"><i class="fa fa-check"></i><b>3.2.4</b> <code>bind_log_odds()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="a-corpus-of-physics-texts.html"><a href="a-corpus-of-physics-texts.html"><i class="fa fa-check"></i><b>3.3</b> A corpus of physics texts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="relationships-between-words-n-grams-and-correlations.html"><a href="relationships-between-words-n-grams-and-correlations.html"><i class="fa fa-check"></i><b>4</b> Relationships between words: n-grams and correlations</a><ul>
<li class="chapter" data-level="4.1" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html"><i class="fa fa-check"></i><b>4.1</b> Tokenizing by n-gram</a><ul>
<li class="chapter" data-level="4.1.1" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#filtering-n-grams"><i class="fa fa-check"></i><b>4.1.1</b> Filtering n-grams</a></li>
<li class="chapter" data-level="4.1.2" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#analyzing-bigrams"><i class="fa fa-check"></i><b>4.1.2</b> Analyzing bigrams</a></li>
<li class="chapter" data-level="4.1.3" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#using-bigrams-to-provide-context-in-sentiment-analysis"><i class="fa fa-check"></i><b>4.1.3</b> Using bigrams to provide context in sentiment analysis</a></li>
<li class="chapter" data-level="4.1.4" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#visualizing-a-network-of-bigrams-with-ggraph"><i class="fa fa-check"></i><b>4.1.4</b> Visualizing a network of bigrams with <code>ggraph</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#visualizing-friends"><i class="fa fa-check"></i><b>4.1.5</b> Visualizing “friends”</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html"><i class="fa fa-check"></i><b>4.2</b> Counting and correlating pairs of words with <code>widyr</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html#counting-and-correlating-among-sections"><i class="fa fa-check"></i><b>4.2.1</b> Counting and correlating among sections</a></li>
<li class="chapter" data-level="4.2.2" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html#pairwise-correlation"><i class="fa fa-check"></i><b>4.2.2</b> Pairwise correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="converting-to-and-from-non-tidy-formats.html"><a href="converting-to-and-from-non-tidy-formats.html"><i class="fa fa-check"></i><b>5</b> Converting to and from non-tidy formats</a><ul>
<li class="chapter" data-level="5.1" data-path="tidying-a-document-term-matrix.html"><a href="tidying-a-document-term-matrix.html"><i class="fa fa-check"></i><b>5.1</b> Tidying a document-term matrix</a></li>
<li class="chapter" data-level="5.2" data-path="casting-tidy-text-data-into-a-matrix.html"><a href="casting-tidy-text-data-into-a-matrix.html"><i class="fa fa-check"></i><b>5.2</b> Casting tidy text data into a matrix</a></li>
<li class="chapter" data-level="5.3" data-path="tidying-corpus-objects-with-metadata.html"><a href="tidying-corpus-objects-with-metadata.html"><i class="fa fa-check"></i><b>5.3</b> Tidying corpus objects with metadata</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topic-modeling.html"><a href="topic-modeling.html"><i class="fa fa-check"></i><b>6</b> Topic modeling</a><ul>
<li class="chapter" data-level="6.1" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>6.1</b> Latent Dirichlet Allocation</a><ul>
<li class="chapter" data-level="6.1.1" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#example-associated-press"><i class="fa fa-check"></i><b>6.1.1</b> Example: Associated Press</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html"><i class="fa fa-check"></i><b>6.2</b> Example: the great library heist</a><ul>
<li class="chapter" data-level="6.2.1" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#lda-on-chapters"><i class="fa fa-check"></i><b>6.2.1</b> LDA on chapters</a></li>
<li class="chapter" data-level="6.2.2" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#per-document-classification"><i class="fa fa-check"></i><b>6.2.2</b> Per-document classification</a></li>
<li class="chapter" data-level="6.2.3" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#by-word-assignments-augment"><i class="fa fa-check"></i><b>6.2.3</b> By word assignments: <code>augment()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="reviews-on-regular-expressions.html"><a href="reviews-on-regular-expressions.html"><i class="fa fa-check"></i><b>A</b> Reviews on regular expressions</a><ul>
<li class="chapter" data-level="A.1" data-path="posix-character-classes.html"><a href="posix-character-classes.html"><i class="fa fa-check"></i><b>A.1</b> POSIX Character Classes</a></li>
<li class="chapter" data-level="A.2" data-path="greedy-and-lazy-quantifiers.html"><a href="greedy-and-lazy-quantifiers.html"><i class="fa fa-check"></i><b>A.2</b> Greedy and lazy quantifiers</a></li>
<li class="chapter" data-level="A.3" data-path="looking-ahead-and-back.html"><a href="looking-ahead-and-back.html"><i class="fa fa-check"></i><b>A.3</b> Looking ahead and back</a></li>
<li class="chapter" data-level="A.4" data-path="backreferences.html"><a href="backreferences.html"><i class="fa fa-check"></i><b>A.4</b> Backreferences</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="text-processing-examples-in-r.html"><a href="text-processing-examples-in-r.html"><i class="fa fa-check"></i><b>B</b> Text processing examples in R</a><ul>
<li class="chapter" data-level="B.1" data-path="replacing-and-removing.html"><a href="replacing-and-removing.html"><i class="fa fa-check"></i><b>B.1</b> Replacing and removing</a></li>
<li class="chapter" data-level="B.2" data-path="combining-and-splitting.html"><a href="combining-and-splitting.html"><i class="fa fa-check"></i><b>B.2</b> Combining and splitting</a></li>
<li class="chapter" data-level="B.3" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html"><i class="fa fa-check"></i><b>B.3</b> Extracting text from pdf and other files</a><ul>
<li class="chapter" data-level="B.3.1" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html#office-documents"><i class="fa fa-check"></i><b>B.3.1</b> Office documents</a></li>
<li class="chapter" data-level="B.3.2" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html#images"><i class="fa fa-check"></i><b>B.3.2</b> Images</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Text Mining with R — Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-the-great-library-heist" class="section level2">
<h2><span class="header-section-number">6.2</span> Example: the great library heist</h2>
<p>To evaluate our topic model, we first divided 4 books into chapters. If a topic model with <span class="math inline">\(K = 4\)</span> performs well, then there should be a corresponding segmentation among those chpaters coming from those 4 different books.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">titles &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Twenty Thousand Leagues under the Sea&quot;</span>, <span class="st">&quot;The War of the Worlds&quot;</span>,</a>
<a class="sourceLine" id="cb109-2" title="2">            <span class="st">&quot;Pride and Prejudice&quot;</span>, <span class="st">&quot;Great Expectations&quot;</span>)  </a>
<a class="sourceLine" id="cb109-3" title="3"></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="kw">library</span>(gutenbergr)</a>
<a class="sourceLine" id="cb109-5" title="5"></a>
<a class="sourceLine" id="cb109-6" title="6">books &lt;-<span class="st"> </span><span class="kw">gutenberg_works</span>(title <span class="op">%in%</span><span class="st"> </span>titles) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="st">  </span><span class="kw">gutenberg_download</span>(<span class="dt">meta_fields =</span> <span class="st">&quot;title&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="co"># add a chapter column</span></a>
<a class="sourceLine" id="cb110-2" title="2">by_chapter &lt;-<span class="st"> </span>books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(title) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">chapter =</span> <span class="kw">cumsum</span>(<span class="kw">str_detect</span>(text, <span class="kw">regex</span>(<span class="st">&quot;^chapter &quot;</span>, <span class="dt">ignore_case =</span> <span class="ot">TRUE</span>)))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-5" title="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-6" title="6"><span class="st">  </span><span class="kw">filter</span>(chapter <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-7" title="7"><span class="st">  </span><span class="kw">unite</span>(document, title, chapter)</a>
<a class="sourceLine" id="cb110-8" title="8"></a>
<a class="sourceLine" id="cb110-9" title="9"></a>
<a class="sourceLine" id="cb110-10" title="10"><span class="co"># find document-word counts</span></a>
<a class="sourceLine" id="cb110-11" title="11">word_counts &lt;-<span class="st"> </span>by_chapter <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-12" title="12"><span class="st">  </span><span class="kw">unnest_tokens</span>(word, text) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-13" title="13"><span class="st">  </span><span class="kw">anti_join</span>(stop_words) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-14" title="14"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">chapter =</span> document) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-15" title="15"><span class="st">  </span><span class="kw">count</span>(chapter, word, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb110-16" title="16"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb110-17" title="17"></a>
<a class="sourceLine" id="cb110-18" title="18">word_counts</a>
<a class="sourceLine" id="cb110-19" title="19"><span class="co">#&gt; # A tibble: 104,722 x 3</span></a>
<a class="sourceLine" id="cb110-20" title="20"><span class="co">#&gt;   chapter               word        n</span></a>
<a class="sourceLine" id="cb110-21" title="21"><span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt;   &lt;int&gt;</span></a>
<a class="sourceLine" id="cb110-22" title="22"><span class="co">#&gt; 1 Great Expectations_57 joe        88</span></a>
<a class="sourceLine" id="cb110-23" title="23"><span class="co">#&gt; 2 Great Expectations_7  joe        70</span></a>
<a class="sourceLine" id="cb110-24" title="24"><span class="co">#&gt; 3 Great Expectations_17 biddy      63</span></a>
<a class="sourceLine" id="cb110-25" title="25"><span class="co">#&gt; 4 Great Expectations_27 joe        58</span></a>
<a class="sourceLine" id="cb110-26" title="26"><span class="co">#&gt; 5 Great Expectations_38 estella    58</span></a>
<a class="sourceLine" id="cb110-27" title="27"><span class="co">#&gt; 6 Great Expectations_2  joe        56</span></a>
<a class="sourceLine" id="cb110-28" title="28"><span class="co">#&gt; # ... with 104,716 more rows</span></a></code></pre></div>
<div id="lda-on-chapters" class="section level3">
<h3><span class="header-section-number">6.2.1</span> LDA on chapters</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1">chapters_dtm &lt;-<span class="st"> </span>word_counts <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb111-2" title="2"><span class="st">  </span><span class="kw">cast_dtm</span>(<span class="dt">document =</span> chapter, <span class="dt">term =</span> word, <span class="dt">value =</span> n)</a>
<a class="sourceLine" id="cb111-3" title="3"></a>
<a class="sourceLine" id="cb111-4" title="4">chapters_lda &lt;-<span class="st"> </span>chapters_dtm <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="st">  </span><span class="kw">LDA</span>(<span class="dt">k  =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Much as we did on the Associated Press data, we can examine per-topic-per-word probabilities.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1">chapter_topics &lt;-<span class="st"> </span><span class="kw">tidy</span>(chapters_lda, <span class="dt">matrix =</span> <span class="st">&quot;beta&quot;</span>)</a>
<a class="sourceLine" id="cb112-2" title="2">chapter_topics</a>
<a class="sourceLine" id="cb112-3" title="3"><span class="co">#&gt; # A tibble: 72,860 x 3</span></a>
<a class="sourceLine" id="cb112-4" title="4"><span class="co">#&gt;   topic term       beta</span></a>
<a class="sourceLine" id="cb112-5" title="5"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="co">#&gt; 1     1 joe   1.45e- 52</span></a>
<a class="sourceLine" id="cb112-7" title="7"><span class="co">#&gt; 2     2 joe   1.44e-  2</span></a>
<a class="sourceLine" id="cb112-8" title="8"><span class="co">#&gt; 3     3 joe   4.69e-118</span></a>
<a class="sourceLine" id="cb112-9" title="9"><span class="co">#&gt; 4     4 joe   3.61e- 19</span></a>
<a class="sourceLine" id="cb112-10" title="10"><span class="co">#&gt; 5     1 biddy 5.21e-181</span></a>
<a class="sourceLine" id="cb112-11" title="11"><span class="co">#&gt; 6     2 biddy 4.75e-  3</span></a>
<a class="sourceLine" id="cb112-12" title="12"><span class="co">#&gt; # ... with 72,854 more rows</span></a></code></pre></div>
<p>We can find top 5 terms within each topic.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">chapter_topics <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(topic) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-3" title="3"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">topic =</span> <span class="kw">str_c</span>(<span class="st">&quot;topic&quot;</span>, topic)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-6" title="6"><span class="st">  </span><span class="kw">facet_bar</span>(<span class="dt">y =</span> term, <span class="dt">x =</span> beta, <span class="dt">by =</span> topic)</a></code></pre></div>
<p><img src="topic-modeling_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>I am not an expert on the other 3 books aside from Pride &amp; Prejudice, but according to <a href="https://www.tidytextmining.com/topicmodeling#lda-on-chapters">Julia</a>, each topic did correspond to one book by and large!</p>
</div>
<div id="per-document-classification" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Per-document classification</h3>
<p>We may want to how which topics are associated with each document, in particular, the majority of chapters in the same book should belong to the same topic (if we assign a chapter<span class="math inline">\(_m\)</span> to a topic<span class="math inline">\(_k\)</span> when the <span class="math inline">\(k\)</span>th postion in <span class="math inline">\(\hat{\theta}_m\)</span> is significantly higher).</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">chapters_gamma &lt;-<span class="st"> </span><span class="kw">tidy</span>(chapters_lda, <span class="dt">matrix =</span> <span class="st">&quot;gamma&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="st">  </span><span class="kw">separate</span>(document, <span class="kw">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;chapter&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb114-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">topic =</span> <span class="kw">factor</span>(topic) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">fct_inseq</span>())</a>
<a class="sourceLine" id="cb114-4" title="4"></a>
<a class="sourceLine" id="cb114-5" title="5">chapters_gamma</a>
<a class="sourceLine" id="cb114-6" title="6"><span class="co">#&gt; # A tibble: 772 x 4</span></a>
<a class="sourceLine" id="cb114-7" title="7"><span class="co">#&gt;   title              chapter topic     gamma</span></a>
<a class="sourceLine" id="cb114-8" title="8"><span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt; &lt;fct&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb114-9" title="9"><span class="co">#&gt; 1 Great Expectations      57 1     0.0000150</span></a>
<a class="sourceLine" id="cb114-10" title="10"><span class="co">#&gt; 2 Great Expectations       7 1     0.0000163</span></a>
<a class="sourceLine" id="cb114-11" title="11"><span class="co">#&gt; 3 Great Expectations      17 1     0.0000234</span></a>
<a class="sourceLine" id="cb114-12" title="12"><span class="co">#&gt; 4 Great Expectations      27 1     0.0000213</span></a>
<a class="sourceLine" id="cb114-13" title="13"><span class="co">#&gt; 5 Great Expectations      38 1     0.0000142</span></a>
<a class="sourceLine" id="cb114-14" title="14"><span class="co">#&gt; 6 Great Expectations       2 1     0.0000191</span></a>
<a class="sourceLine" id="cb114-15" title="15"><span class="co">#&gt; # ... with 766 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="kw">ggplot</span>(chapters_gamma) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(topic, gamma)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb115-3" title="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>title)</a></code></pre></div>
<p><img src="topic-modeling_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ideally we would expect that in every book panel, there is one boxplot highly centered at 1 with the other 3 boxes at 0, since chapters in the same book are categorized in the same topic.</p>
<p>It does look like some chapters from Great Expectations (which should be topic 4) were somewhat associated with other topics. Are there any cases where the topic most associated with a chapter belonged to another book?</p>
<p>First we’d find the topic that was most associated with each chapter using <code>top_n()</code>, which is effectively the “classification” of that chapter.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">chapter_classifications &lt;-<span class="st"> </span>chapters_gamma <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(title, chapter) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">1</span>, gamma) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb116-4" title="4"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb116-5" title="5"></a>
<a class="sourceLine" id="cb116-6" title="6">chapter_classifications</a>
<a class="sourceLine" id="cb116-7" title="7"><span class="co">#&gt; # A tibble: 193 x 4</span></a>
<a class="sourceLine" id="cb116-8" title="8"><span class="co">#&gt;   title               chapter topic gamma</span></a>
<a class="sourceLine" id="cb116-9" title="9"><span class="co">#&gt;   &lt;chr&gt;                 &lt;int&gt; &lt;fct&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb116-10" title="10"><span class="co">#&gt; 1 Pride and Prejudice      43 1     1.00 </span></a>
<a class="sourceLine" id="cb116-11" title="11"><span class="co">#&gt; 2 Pride and Prejudice      18 1     1.00 </span></a>
<a class="sourceLine" id="cb116-12" title="12"><span class="co">#&gt; 3 Pride and Prejudice      45 1     1.00 </span></a>
<a class="sourceLine" id="cb116-13" title="13"><span class="co">#&gt; 4 Pride and Prejudice      16 1     1.00 </span></a>
<a class="sourceLine" id="cb116-14" title="14"><span class="co">#&gt; 5 Pride and Prejudice      29 1     0.988</span></a>
<a class="sourceLine" id="cb116-15" title="15"><span class="co">#&gt; 6 Pride and Prejudice      10 1     1.00 </span></a>
<a class="sourceLine" id="cb116-16" title="16"><span class="co">#&gt; # ... with 187 more rows</span></a></code></pre></div>
<p>We can then compare each to the “consensus” topic for each book (the most common topic among its chapters), and see which were most often misidentified.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co"># identify which topic is most related to which book</span></a>
<a class="sourceLine" id="cb117-2" title="2">book_topics &lt;-<span class="st"> </span>chapter_classifications <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-3" title="3"><span class="st">  </span><span class="kw">count</span>(title, topic) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(title) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-5" title="5"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">1</span>, n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-6" title="6"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb117-7" title="7"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">consensus =</span> title, topic)</a>
<a class="sourceLine" id="cb117-8" title="8"></a>
<a class="sourceLine" id="cb117-9" title="9"><span class="co"># which chapter in misidentified</span></a>
<a class="sourceLine" id="cb117-10" title="10">chapter_classifications <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb117-11" title="11"><span class="st">  </span><span class="kw">inner_join</span>(book_topics) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb117-12" title="12"><span class="st">  </span><span class="kw">filter</span>(consensus <span class="op">!=</span><span class="st"> </span>title)</a>
<a class="sourceLine" id="cb117-13" title="13"><span class="co">#&gt; # A tibble: 5 x 5</span></a>
<a class="sourceLine" id="cb117-14" title="14"><span class="co">#&gt;   title              chapter topic gamma consensus            </span></a>
<a class="sourceLine" id="cb117-15" title="15"><span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt; &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;                </span></a>
<a class="sourceLine" id="cb117-16" title="16"><span class="co">#&gt; 1 Great Expectations      20 4     0.521 The War of the Worlds</span></a>
<a class="sourceLine" id="cb117-17" title="17"><span class="co">#&gt; 2 Great Expectations      37 4     0.451 The War of the Worlds</span></a>
<a class="sourceLine" id="cb117-18" title="18"><span class="co">#&gt; 3 Great Expectations      54 4     0.742 The War of the Worlds</span></a>
<a class="sourceLine" id="cb117-19" title="19"><span class="co">#&gt; 4 Great Expectations      45 4     0.556 The War of the Worlds</span></a>
<a class="sourceLine" id="cb117-20" title="20"><span class="co">#&gt; 5 Great Expectations      21 4     0.527 The War of the Worlds</span></a></code></pre></div>
<p>We see that one chapter in “Great Expectation” is misidentified as a member of topic 3, which is essentially “The War of the Worlds”</p>
</div>
<div id="by-word-assignments-augment" class="section level3">
<h3><span class="header-section-number">6.2.3</span> By word assignments: <code>augment()</code></h3>
<p>One step of the LDA algorithm is assigning each word in each document to a topic <span class="math inline">\(z_{m, n}\)</span>. The more words in a document are assigned to that topic, generally, the more weight <span class="math inline">\(\theta_m\)</span> will go on that document-topic classification.</p>
<p>We may want to take the original document-word pairs and find which words in each document were assigned to which topic. This is the job of the <code>augment()</code> function, which is to add information to each observation in the original data.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">assignments &lt;-<span class="st"> </span><span class="kw">augment</span>(chapters_lda, <span class="dt">data =</span> chapters_dtm) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb118-2" title="2"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">chapter =</span> document)</a>
<a class="sourceLine" id="cb118-3" title="3">assignments</a>
<a class="sourceLine" id="cb118-4" title="4"><span class="co">#&gt; # A tibble: 104,722 x 4</span></a>
<a class="sourceLine" id="cb118-5" title="5"><span class="co">#&gt;   chapter               term  count .topic</span></a>
<a class="sourceLine" id="cb118-6" title="6"><span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb118-7" title="7"><span class="co">#&gt; 1 Great Expectations_57 joe      88      2</span></a>
<a class="sourceLine" id="cb118-8" title="8"><span class="co">#&gt; 2 Great Expectations_7  joe      70      2</span></a>
<a class="sourceLine" id="cb118-9" title="9"><span class="co">#&gt; 3 Great Expectations_17 joe       5      2</span></a>
<a class="sourceLine" id="cb118-10" title="10"><span class="co">#&gt; 4 Great Expectations_27 joe      58      2</span></a>
<a class="sourceLine" id="cb118-11" title="11"><span class="co">#&gt; 5 Great Expectations_2  joe      56      2</span></a>
<a class="sourceLine" id="cb118-12" title="12"><span class="co">#&gt; 6 Great Expectations_23 joe       1      2</span></a>
<a class="sourceLine" id="cb118-13" title="13"><span class="co">#&gt; # ... with 104,716 more rows</span></a></code></pre></div>
<p>To get a sense of how our model works, we can draw a bar plot of assigned topics in each book</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">assignments <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="st">  </span><span class="kw">separate</span>(chapter, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;chapter&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="st">  </span><span class="kw">count</span>(title, .topic, <span class="dt">wt =</span> count) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb119-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(.topic, n)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-5" title="5"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">width =</span> <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>title)</a></code></pre></div>
<p><img src="topic-modeling_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can combine this assignments table with the <code>consensus</code> book titles to find which words were incorrectly classified by a coofusion matrix.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">assignments &lt;-<span class="st"> </span>assignments <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="st">  </span><span class="kw">separate</span>(chapter, <span class="kw">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;chapter&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="dt">convert =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb120-3" title="3"><span class="st">  </span><span class="kw">inner_join</span>(book_topics, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;.topic&quot;</span> =<span class="st"> &quot;topic&quot;</span>))</a>
<a class="sourceLine" id="cb120-4" title="4"></a>
<a class="sourceLine" id="cb120-5" title="5">assignments</a>
<a class="sourceLine" id="cb120-6" title="6"><span class="co">#&gt; # A tibble: 104,722 x 6</span></a>
<a class="sourceLine" id="cb120-7" title="7"><span class="co">#&gt;   title              chapter term  count .topic consensus         </span></a>
<a class="sourceLine" id="cb120-8" title="8"><span class="co">#&gt;   &lt;chr&gt;                &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;             </span></a>
<a class="sourceLine" id="cb120-9" title="9"><span class="co">#&gt; 1 Great Expectations      57 joe      88      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-10" title="10"><span class="co">#&gt; 2 Great Expectations       7 joe      70      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-11" title="11"><span class="co">#&gt; 3 Great Expectations      17 joe       5      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-12" title="12"><span class="co">#&gt; 4 Great Expectations      27 joe      58      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-13" title="13"><span class="co">#&gt; 5 Great Expectations       2 joe      56      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-14" title="14"><span class="co">#&gt; 6 Great Expectations      23 joe       1      2 Great Expectations</span></a>
<a class="sourceLine" id="cb120-15" title="15"><span class="co">#&gt; # ... with 104,716 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="co"># confusion matrix  </span></a>
<a class="sourceLine" id="cb121-2" title="2">assignments <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-3" title="3"><span class="st">  </span><span class="kw">count</span>(title, consensus, <span class="dt">wt =</span> count) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-4" title="4"><span class="st">  </span><span class="kw">group_by</span>(title) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-6" title="6"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-7" title="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(consensus, title, <span class="dt">fill =</span> percent)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-8" title="8"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-9" title="9"><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">high =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent_format</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb121-10" title="10"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_axis</span>(<span class="dt">n.dodge =</span> <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-11" title="11"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb121-12" title="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb121-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Book words were assigned to&quot;</span>,</a>
<a class="sourceLine" id="cb121-14" title="14">       <span class="dt">y =</span> <span class="st">&quot;Book words came from&quot;</span>,</a>
<a class="sourceLine" id="cb121-15" title="15">       <span class="dt">fill =</span> <span class="st">&quot;% of assignments&quot;</span>)</a></code></pre></div>
<p><img src="topic-modeling_files/figure-html/unnamed-chunk-23-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>What were the most commonly mistaken words?</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1">assignments <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb122-2" title="2"><span class="st">  </span><span class="kw">filter</span>(title <span class="op">!=</span><span class="st"> </span>consensus) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb122-3" title="3"><span class="st">  </span><span class="kw">count</span>(title, consensus, term, <span class="dt">.wt =</span> count) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb122-4" title="4"><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(n))</a>
<a class="sourceLine" id="cb122-5" title="5"><span class="co">#&gt; # A tibble: 3,523 x 5</span></a>
<a class="sourceLine" id="cb122-6" title="6"><span class="co">#&gt;   title              consensus             term        .wt     n</span></a>
<a class="sourceLine" id="cb122-7" title="7"><span class="co">#&gt;   &lt;chr&gt;              &lt;chr&gt;                 &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb122-8" title="8"><span class="co">#&gt; 1 Great Expectations The War of the Worlds britain       1    11</span></a>
<a class="sourceLine" id="cb122-9" title="9"><span class="co">#&gt; 2 Great Expectations The War of the Worlds yards         1     8</span></a>
<a class="sourceLine" id="cb122-10" title="10"><span class="co">#&gt; 3 Great Expectations The War of the Worlds deep          1     7</span></a>
<a class="sourceLine" id="cb122-11" title="11"><span class="co">#&gt; 4 Great Expectations The War of the Worlds direction     1     7</span></a>
<a class="sourceLine" id="cb122-12" title="12"><span class="co">#&gt; 5 Great Expectations The War of the Worlds feet          1     7</span></a>
<a class="sourceLine" id="cb122-13" title="13"><span class="co">#&gt; 6 Great Expectations The War of the Worlds london        1     7</span></a>
<a class="sourceLine" id="cb122-14" title="14"><span class="co">#&gt; # ... with 3,517 more rows</span></a></code></pre></div>
<p>We can see that a number of words were often assigned to the Pride and Prejudice or War of the Worlds cluster even when they appeared in Great Expectations. For some of these words, such as “love” and “lady”, that’s because they’re more common in Pride and Prejudice (we could confirm that by examining the counts).</p>
<p>It is possible that a word is assigned to a book, even though it never appears in that book.</p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="latent-dirichlet-allocation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/tidy-text-mining/edit/master/book/topic-modeling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
