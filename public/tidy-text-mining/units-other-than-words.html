<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.6 Units other than words | Notes for “Text Mining with R: A Tidy Approach”</title>
  <meta name="description" content="2.6 Units other than words | Notes for “Text Mining with R: A Tidy Approach”" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="2.6 Units other than words | Notes for “Text Mining with R: A Tidy Approach”" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="enixam/tidy-text-mining" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.6 Units other than words | Notes for “Text Mining with R: A Tidy Approach”" />
  
  
  

<meta name="author" content="Qiushi Yan" />


<meta name="date" content="2020-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wordclouds.html"/>
<link rel="next" href="analyzing-word-and-document-frequency.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for Text Mining with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Text Mining with R</b></span></li>
<li class="chapter" data-level="1" data-path="tidy-text-format.html"><a href="tidy-text-format.html"><i class="fa fa-check"></i><b>1</b> Tidy text format</a><ul>
<li class="chapter" data-level="1.1" data-path="the-unnest-tokens-function.html"><a href="the-unnest-tokens-function.html"><i class="fa fa-check"></i><b>1.1</b> The <code>unnest_tokens()</code> function</a></li>
<li class="chapter" data-level="1.2" data-path="the-gutenbergr-package.html"><a href="the-gutenbergr-package.html"><i class="fa fa-check"></i><b>1.2</b> The <code>gutenbergr</code> package</a></li>
<li class="chapter" data-level="1.3" data-path="compare-word-frequency.html"><a href="compare-word-frequency.html"><i class="fa fa-check"></i><b>1.3</b> Compare word frequency</a></li>
<li class="chapter" data-level="1.4" data-path="other-tokenization-methods.html"><a href="other-tokenization-methods.html"><i class="fa fa-check"></i><b>1.4</b> Other tokenization methods</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sentiment-analysis-with-tidy-data.html"><a href="sentiment-analysis-with-tidy-data.html"><i class="fa fa-check"></i><b>2</b> Sentiment analysis with tidy data</a><ul>
<li class="chapter" data-level="2.1" data-path="the-sentiments-dataset.html"><a href="the-sentiments-dataset.html"><i class="fa fa-check"></i><b>2.1</b> The <code>sentiments</code> dataset</a></li>
<li class="chapter" data-level="2.2" data-path="sentiment-analysis-with-inner-join.html"><a href="sentiment-analysis-with-inner-join.html"><i class="fa fa-check"></i><b>2.2</b> Sentiment analysis with inner join</a></li>
<li class="chapter" data-level="2.3" data-path="comparing-3-different-dictionaries.html"><a href="comparing-3-different-dictionaries.html"><i class="fa fa-check"></i><b>2.3</b> Comparing 3 different dictionaries</a></li>
<li class="chapter" data-level="2.4" data-path="most-common-positive-and-negative-words.html"><a href="most-common-positive-and-negative-words.html"><i class="fa fa-check"></i><b>2.4</b> Most common positive and negative words</a></li>
<li class="chapter" data-level="2.5" data-path="wordclouds.html"><a href="wordclouds.html"><i class="fa fa-check"></i><b>2.5</b> Wordclouds</a></li>
<li class="chapter" data-level="2.6" data-path="units-other-than-words.html"><a href="units-other-than-words.html"><i class="fa fa-check"></i><b>2.6</b> Units other than words</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="analyzing-word-and-document-frequency.html"><a href="analyzing-word-and-document-frequency.html"><i class="fa fa-check"></i><b>3</b> Analyzing word and document frequency</a><ul>
<li class="chapter" data-level="3.1" data-path="tf-idf.html"><a href="tf-idf.html"><i class="fa fa-check"></i><b>3.1</b> tf-idf</a><ul>
<li class="chapter" data-level="3.1.1" data-path="tf-idf.html"><a href="tf-idf.html#term-frequency-in-jane-austens-novels"><i class="fa fa-check"></i><b>3.1.1</b> Term frequency in Jane Austen’s novels</a></li>
<li class="chapter" data-level="3.1.2" data-path="tf-idf.html"><a href="tf-idf.html#zipfs-law"><i class="fa fa-check"></i><b>3.1.2</b> Zipf’s law</a></li>
<li class="chapter" data-level="3.1.3" data-path="tf-idf.html"><a href="tf-idf.html#word-rank-slope-chart"><i class="fa fa-check"></i><b>3.1.3</b> Word rank slope chart</a></li>
<li class="chapter" data-level="3.1.4" data-path="tf-idf.html"><a href="tf-idf.html#the-bind_tf_idf-function"><i class="fa fa-check"></i><b>3.1.4</b> The <code>bind_tf_idf()</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html"><i class="fa fa-check"></i><b>3.2</b> Weighted log odds ratio</a><ul>
<li class="chapter" data-level="3.2.1" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#log-odds-ratio"><i class="fa fa-check"></i><b>3.2.1</b> Log odds ratio</a></li>
<li class="chapter" data-level="3.2.2" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#model-based-approach-weighted-log-odds-ratio"><i class="fa fa-check"></i><b>3.2.2</b> Model-based approach: Weighted log odds ratio</a></li>
<li class="chapter" data-level="3.2.3" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#discussions"><i class="fa fa-check"></i><b>3.2.3</b> Discussions</a></li>
<li class="chapter" data-level="3.2.4" data-path="weighted-log-odds-ratio.html"><a href="weighted-log-odds-ratio.html#bind_log_odds"><i class="fa fa-check"></i><b>3.2.4</b> <code>bind_log_odds()</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="a-corpus-of-physics-texts.html"><a href="a-corpus-of-physics-texts.html"><i class="fa fa-check"></i><b>3.3</b> A corpus of physics texts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="relationships-between-words-n-grams-and-correlations.html"><a href="relationships-between-words-n-grams-and-correlations.html"><i class="fa fa-check"></i><b>4</b> Relationships between words: n-grams and correlations</a><ul>
<li class="chapter" data-level="4.1" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html"><i class="fa fa-check"></i><b>4.1</b> Tokenizing by n-gram</a><ul>
<li class="chapter" data-level="4.1.1" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#filtering-n-grams"><i class="fa fa-check"></i><b>4.1.1</b> Filtering n-grams</a></li>
<li class="chapter" data-level="4.1.2" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#analyzing-bigrams"><i class="fa fa-check"></i><b>4.1.2</b> Analyzing bigrams</a></li>
<li class="chapter" data-level="4.1.3" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#using-bigrams-to-provide-context-in-sentiment-analysis"><i class="fa fa-check"></i><b>4.1.3</b> Using bigrams to provide context in sentiment analysis</a></li>
<li class="chapter" data-level="4.1.4" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#visualizing-a-network-of-bigrams-with-ggraph"><i class="fa fa-check"></i><b>4.1.4</b> Visualizing a network of bigrams with <code>ggraph</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="tokenizing-by-n-gram.html"><a href="tokenizing-by-n-gram.html#visualizing-friends"><i class="fa fa-check"></i><b>4.1.5</b> Visualizing “friends”</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html"><i class="fa fa-check"></i><b>4.2</b> Counting and correlating pairs of words with <code>widyr</code></a><ul>
<li class="chapter" data-level="4.2.1" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html#counting-and-correlating-among-sections"><i class="fa fa-check"></i><b>4.2.1</b> Counting and correlating among sections</a></li>
<li class="chapter" data-level="4.2.2" data-path="counting-and-correlating-pairs-of-words-with-widyr.html"><a href="counting-and-correlating-pairs-of-words-with-widyr.html#pairwise-correlation"><i class="fa fa-check"></i><b>4.2.2</b> Pairwise correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="converting-to-and-from-non-tidy-formats.html"><a href="converting-to-and-from-non-tidy-formats.html"><i class="fa fa-check"></i><b>5</b> Converting to and from non-tidy formats</a><ul>
<li class="chapter" data-level="5.1" data-path="tidying-a-document-term-matrix.html"><a href="tidying-a-document-term-matrix.html"><i class="fa fa-check"></i><b>5.1</b> Tidying a document-term matrix</a></li>
<li class="chapter" data-level="5.2" data-path="casting-tidy-text-data-into-a-matrix.html"><a href="casting-tidy-text-data-into-a-matrix.html"><i class="fa fa-check"></i><b>5.2</b> Casting tidy text data into a matrix</a></li>
<li class="chapter" data-level="5.3" data-path="tidying-corpus-objects-with-metadata.html"><a href="tidying-corpus-objects-with-metadata.html"><i class="fa fa-check"></i><b>5.3</b> Tidying corpus objects with metadata</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="topic-modeling.html"><a href="topic-modeling.html"><i class="fa fa-check"></i><b>6</b> Topic modeling</a><ul>
<li class="chapter" data-level="6.1" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html"><i class="fa fa-check"></i><b>6.1</b> Latent Dirichlet Allocation</a><ul>
<li class="chapter" data-level="6.1.1" data-path="latent-dirichlet-allocation.html"><a href="latent-dirichlet-allocation.html#example-associated-press"><i class="fa fa-check"></i><b>6.1.1</b> Example: Associated Press</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html"><i class="fa fa-check"></i><b>6.2</b> Example: the great library heist</a><ul>
<li class="chapter" data-level="6.2.1" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#lda-on-chapters"><i class="fa fa-check"></i><b>6.2.1</b> LDA on chapters</a></li>
<li class="chapter" data-level="6.2.2" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#per-document-classification"><i class="fa fa-check"></i><b>6.2.2</b> Per-document classification</a></li>
<li class="chapter" data-level="6.2.3" data-path="example-the-great-library-heist.html"><a href="example-the-great-library-heist.html#by-word-assignments-augment"><i class="fa fa-check"></i><b>6.2.3</b> By word assignments: <code>augment()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="reviews-on-regular-expressions.html"><a href="reviews-on-regular-expressions.html"><i class="fa fa-check"></i><b>A</b> Reviews on regular expressions</a><ul>
<li class="chapter" data-level="A.1" data-path="posix-character-classes.html"><a href="posix-character-classes.html"><i class="fa fa-check"></i><b>A.1</b> POSIX Character Classes</a></li>
<li class="chapter" data-level="A.2" data-path="greedy-and-lazy-quantifiers.html"><a href="greedy-and-lazy-quantifiers.html"><i class="fa fa-check"></i><b>A.2</b> Greedy and lazy quantifiers</a></li>
<li class="chapter" data-level="A.3" data-path="looking-ahead-and-back.html"><a href="looking-ahead-and-back.html"><i class="fa fa-check"></i><b>A.3</b> Looking ahead and back</a></li>
<li class="chapter" data-level="A.4" data-path="backreferences.html"><a href="backreferences.html"><i class="fa fa-check"></i><b>A.4</b> Backreferences</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="text-processing-examples-in-r.html"><a href="text-processing-examples-in-r.html"><i class="fa fa-check"></i><b>B</b> Text processing examples in R</a><ul>
<li class="chapter" data-level="B.1" data-path="replacing-and-removing.html"><a href="replacing-and-removing.html"><i class="fa fa-check"></i><b>B.1</b> Replacing and removing</a></li>
<li class="chapter" data-level="B.2" data-path="combining-and-splitting.html"><a href="combining-and-splitting.html"><i class="fa fa-check"></i><b>B.2</b> Combining and splitting</a></li>
<li class="chapter" data-level="B.3" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html"><i class="fa fa-check"></i><b>B.3</b> Extracting text from pdf and other files</a><ul>
<li class="chapter" data-level="B.3.1" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html#office-documents"><i class="fa fa-check"></i><b>B.3.1</b> Office documents</a></li>
<li class="chapter" data-level="B.3.2" data-path="extracting-text-from-pdf-and-other-files.html"><a href="extracting-text-from-pdf-and-other-files.html#images"><i class="fa fa-check"></i><b>B.3.2</b> Images</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Written with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for “Text Mining with R: A Tidy Approach”</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="units-other-than-words" class="section level2">
<h2><span class="header-section-number">2.6</span> Units other than words</h2>
<p>Some sentiment analysis algorithms look beyond only unigrams (i.e. single words) to try to understand the sentiment of a sentence as a whole.</p>
<p>We may want to tokenize text into sentences, and it makes sense to use a new name for the output column in such a case.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">PandP_sentences &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">text =</span> prideprejudice) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="st">  </span><span class="kw">unnest_tokens</span>(sentence, text, <span class="dt">token =</span> <span class="st">&quot;sentences&quot;</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4">PandP_sentences</a>
<a class="sourceLine" id="cb39-5" title="5"><span class="co">#&gt; # A tibble: 7,066 x 1</span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co">#&gt;   sentence                                                                      </span></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">#&gt;   &lt;chr&gt;                                                                         </span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">#&gt; 1 &quot;pride and prejudice  by jane austen    chapter 1   it is a truth universally~</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="co">#&gt; 2 &quot;however little known the feelings or views of such a man may be on his first~</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co">#&gt; 3 &quot;\&quot;my dear mr.&quot;                                                               </span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="co">#&gt; 4 &quot;bennet,\&quot; said his lady to him one day, \&quot;have you heard that netherfield pa~</span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co">#&gt; 5 &quot;mr.&quot;                                                                         </span></a>
<a class="sourceLine" id="cb39-13" title="13"><span class="co">#&gt; 6 &quot;bennet replied that he had not.&quot;                                             </span></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="co">#&gt; # ... with 7,060 more rows</span></a></code></pre></div>
<p>The sentence tokenizing does seem to have a bit of trouble with UTF-8 encoded text, especially with sections of dialogue; it does much better with punctuation in ASCII. One possibility, if this is important, is to try using <code>iconv()</code>, with something like <code>iconv(text, to = 'latin1')</code> in a mutate statement before unnesting.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">tibble</span>(<span class="dt">text =</span> prideprejudice) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">text =</span> <span class="kw">iconv</span>(text, <span class="dt">to =</span> <span class="st">&quot;ASCII&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="st">  </span><span class="kw">unnest_tokens</span>(sentence, text, <span class="dt">token =</span> <span class="st">&quot;sentences&quot;</span>)</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co">#&gt; # A tibble: 7,066 x 1</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="co">#&gt;   sentence                                                                      </span></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co">#&gt;   &lt;chr&gt;                                                                         </span></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="co">#&gt; 1 &quot;pride and prejudice  by jane austen    chapter 1   it is a truth universally~</span></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co">#&gt; 2 &quot;however little known the feelings or views of such a man may be on his first~</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="co">#&gt; 3 &quot;\&quot;my dear mr.&quot;                                                               </span></a>
<a class="sourceLine" id="cb40-10" title="10"><span class="co">#&gt; 4 &quot;bennet,\&quot; said his lady to him one day, \&quot;have you heard that netherfield pa~</span></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="co">#&gt; 5 &quot;mr.&quot;                                                                         </span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="co">#&gt; 6 &quot;bennet replied that he had not.&quot;                                             </span></a>
<a class="sourceLine" id="cb40-13" title="13"><span class="co">#&gt; # ... with 7,060 more rows</span></a></code></pre></div>
<p>Another option in <code>unnest_tokens()</code> is to split into tokens using a regex pattern. We could use this, for example, to split the text of Jane Austen’s novels into a data frame by chapter.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"></a>
<a class="sourceLine" id="cb41-2" title="2">austen_chapters &lt;-<span class="st"> </span><span class="kw">austen_books</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(book) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="st">  </span><span class="kw">unnest_tokens</span>(chapter, text, <span class="dt">token =</span> <span class="st">&quot;regex&quot;</span>, </a>
<a class="sourceLine" id="cb41-5" title="5">                <span class="dt">pattern =</span> <span class="st">&quot;Chapter|CHAPTER [</span><span class="ch">\\</span><span class="st">dIVXLC]&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb41-7" title="7"></a>
<a class="sourceLine" id="cb41-8" title="8"><span class="co"># 275 rows</span></a>
<a class="sourceLine" id="cb41-9" title="9">austen_chapters</a>
<a class="sourceLine" id="cb41-10" title="10"><span class="co">#&gt; # A tibble: 275 x 2</span></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="co">#&gt;   book             chapter                                                      </span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="co">#&gt;   &lt;fct&gt;            &lt;chr&gt;                                                        </span></a>
<a class="sourceLine" id="cb41-13" title="13"><span class="co">#&gt; 1 Sense &amp; Sensibi~ &quot;sense and sensibility\n\nby jane austen\n\n(1811)\n\n\n\n\n&quot;</span></a>
<a class="sourceLine" id="cb41-14" title="14"><span class="co">#&gt; 2 Sense &amp; Sensibi~ &quot;\n\n\nthe family of dashwood had long been settled in susse~</span></a>
<a class="sourceLine" id="cb41-15" title="15"><span class="co">#&gt; 3 Sense &amp; Sensibi~ &quot;\n\n\nmrs. john dashwood now installed herself mistress of ~</span></a>
<a class="sourceLine" id="cb41-16" title="16"><span class="co">#&gt; 4 Sense &amp; Sensibi~ &quot;\n\n\nmrs. dashwood remained at norland several months; not~</span></a>
<a class="sourceLine" id="cb41-17" title="17"><span class="co">#&gt; 5 Sense &amp; Sensibi~ &quot;\n\n\n\&quot;what a pity it is, elinor,\&quot; said marianne, \&quot;that ~</span></a>
<a class="sourceLine" id="cb41-18" title="18"><span class="co">#&gt; 6 Sense &amp; Sensibi~ &quot;\n\n\nno sooner was her answer dispatched, than mrs. dashwo~</span></a>
<a class="sourceLine" id="cb41-19" title="19"><span class="co">#&gt; # ... with 269 more rows</span></a>
<a class="sourceLine" id="cb41-20" title="20"></a>
<a class="sourceLine" id="cb41-21" title="21"><span class="co"># 275 rows</span></a>
<a class="sourceLine" id="cb41-22" title="22">tidy_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-23" title="23"><span class="st">  </span><span class="kw">distinct</span>(book, chapter)</a>
<a class="sourceLine" id="cb41-24" title="24"><span class="co">#&gt; # A tibble: 275 x 2</span></a>
<a class="sourceLine" id="cb41-25" title="25"><span class="co">#&gt;   book                chapter</span></a>
<a class="sourceLine" id="cb41-26" title="26"><span class="co">#&gt;   &lt;fct&gt;                 &lt;int&gt;</span></a>
<a class="sourceLine" id="cb41-27" title="27"><span class="co">#&gt; 1 Sense &amp; Sensibility       0</span></a>
<a class="sourceLine" id="cb41-28" title="28"><span class="co">#&gt; 2 Sense &amp; Sensibility       1</span></a>
<a class="sourceLine" id="cb41-29" title="29"><span class="co">#&gt; 3 Sense &amp; Sensibility       2</span></a>
<a class="sourceLine" id="cb41-30" title="30"><span class="co">#&gt; 4 Sense &amp; Sensibility       3</span></a>
<a class="sourceLine" id="cb41-31" title="31"><span class="co">#&gt; 5 Sense &amp; Sensibility       4</span></a>
<a class="sourceLine" id="cb41-32" title="32"><span class="co">#&gt; 6 Sense &amp; Sensibility       5</span></a>
<a class="sourceLine" id="cb41-33" title="33"><span class="co">#&gt; # ... with 269 more rows</span></a></code></pre></div>
<p>In the <code>austen_chapters</code> data frame, each row corresponds to one chapter.</p>
<p>Near the beginning of this chapter, we used a similar regex to find where all the chapters were in Austen’s novels for a tidy data frame organized by one-word-per-row (Section <a href="sentiment-analysis-with-inner-join.html#sentiment-analysis-with-inner-join">2.2</a>). Using a regex as the token is somewhat similar to</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">tidy_books <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(book, chapter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="kw">str_c</span>(word, <span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>))</a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">#&gt; # A tibble: 275 x 3</span></a>
<a class="sourceLine" id="cb42-5" title="5"><span class="co">#&gt; # Groups:   book [6]</span></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co">#&gt;   book           chapter `str_c(word, collapse = &quot; &quot;)`                          </span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="co">#&gt;   &lt;fct&gt;            &lt;int&gt; &lt;chr&gt;                                                  </span></a>
<a class="sourceLine" id="cb42-8" title="8"><span class="co">#&gt; 1 Sense &amp; Sensi~       0 sense and sensibility by jane austen 1811              </span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="co">#&gt; 2 Sense &amp; Sensi~       1 chapter 1 the family of dashwood had long been settled~</span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="co">#&gt; 3 Sense &amp; Sensi~       2 chapter 2 mrs john dashwood now installed herself mist~</span></a>
<a class="sourceLine" id="cb42-11" title="11"><span class="co">#&gt; 4 Sense &amp; Sensi~       3 chapter 3 mrs dashwood remained at norland several mon~</span></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="co">#&gt; 5 Sense &amp; Sensi~       4 chapter 4 what a pity it is elinor said marianne that ~</span></a>
<a class="sourceLine" id="cb42-13" title="13"><span class="co">#&gt; 6 Sense &amp; Sensi~       5 chapter 5 no sooner was her answer dispatched than mrs~</span></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="co">#&gt; # ... with 269 more rows</span></a></code></pre></div>
<p>We can use tidy text analysis to ask questions such as what are the most negative chapters in each of Jane Austen’s novels? First, let’s get the list of negative words from the Bing lexicon. Second, let’s make a data frame of how many words are in each chapter so we can normalize for the length of chapters. Then, let’s find the number of negative words in each chapter and divide by the total words in each chapter. For each book, which chapter has the highest proportion of negative words?</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">bing_negative &lt;-<span class="st"> </span><span class="kw">get_sentiments</span>(<span class="st">&quot;bing&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="st">  </span><span class="kw">filter</span>(sentiment <span class="op">==</span><span class="st"> &quot;negative&quot;</span>)</a>
<a class="sourceLine" id="cb43-3" title="3"></a>
<a class="sourceLine" id="cb43-4" title="4">chapter_words &lt;-<span class="st"> </span>tidy_books <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-5" title="5"><span class="st">  </span><span class="kw">count</span>(book, chapter)</a>
<a class="sourceLine" id="cb43-6" title="6"></a>
<a class="sourceLine" id="cb43-7" title="7">tidy_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-8" title="8"><span class="st">  </span><span class="kw">semi_join</span>(bing_negative) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="st">  </span><span class="kw">count</span>(book, chapter, <span class="dt">name =</span> <span class="st">&quot;negative_words&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-10" title="10"><span class="st">  </span><span class="kw">left_join</span>(chapter_words) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ratio =</span> negative_words <span class="op">/</span><span class="st"> </span>n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="st">  </span><span class="kw">filter</span>(chapter <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb43-13" title="13"><span class="st">  </span><span class="kw">group_by</span>(book) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="st">  </span><span class="kw">top_n</span>(<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb43-15" title="15"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="co">#&gt; # Groups:   book [6]</span></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="co">#&gt;   book                chapter negative_words     n  ratio</span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="co">#&gt;   &lt;fct&gt;                 &lt;int&gt;          &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb43-19" title="19"><span class="co">#&gt; 1 Sense &amp; Sensibility      43            161  3405 0.0473</span></a>
<a class="sourceLine" id="cb43-20" title="20"><span class="co">#&gt; 2 Pride &amp; Prejudice        34            111  2104 0.0528</span></a>
<a class="sourceLine" id="cb43-21" title="21"><span class="co">#&gt; 3 Mansfield Park           46            173  3685 0.0469</span></a>
<a class="sourceLine" id="cb43-22" title="22"><span class="co">#&gt; 4 Emma                     15            151  3340 0.0452</span></a>
<a class="sourceLine" id="cb43-23" title="23"><span class="co">#&gt; 5 Northanger Abbey         21            149  2982 0.0500</span></a>
<a class="sourceLine" id="cb43-24" title="24"><span class="co">#&gt; 6 Persuasion                4             62  1807 0.0343</span></a></code></pre></div>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="wordclouds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyzing-word-and-document-frequency.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/enixam/tidy-text-mining/edit/master/book/sentiment-analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
